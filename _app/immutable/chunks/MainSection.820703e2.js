import{s as P,e as Q,u as U,g as V,f as X,c as b,d as _,b as Y}from"./scheduler.6402f0dd.js";import{S as Z,i as x,g as $,s as tt,h as et,j as lt,c as st,f as B,k as q,a as R,x as it,d as nt,t as at,H as ot,e as v,F as ht}from"./index.54bf10e2.js";import{j as E}from"./singletons.cef4a821.js";import{t as rt,s as S,h as y}from"./store.be990f37.js";const wt=E("goto"),ct=E("before_navigate"),ft=E("after_navigate"),ut=(s,t)=>{let i=0,e=0,n=0;return function(){e=Date.now(),clearTimeout(n),e-i>=t?(i=e,s()):n=setTimeout(s,t)}};function A(s){let t,i;return{c(){t=new ot(!1),i=v(),this.h()},l(e){t=ht(e,!1),i=v(),this.h()},h(){t.a=i},m(e,n){t.m(s[0],e,n),R(e,i,n)},p(e,n){n&1&&t.p(e[0])},d(e){e&&(B(i),t.d())}}}function mt(s){let t,i,e,n;const f=s[6].default,h=Q(f,s,s[5],null);let o=s[0]&&A(s);return{c(){t=$("main"),h&&h.c(),i=tt(),o&&o.c(),this.h()},l(l){t=et(l,"MAIN",{class:!0});var r=lt(t);h&&h.l(r),i=st(r),o&&o.l(r),r.forEach(B),this.h()},h(){q(t,"class",e=`max-w-[900px] w-full py-2 ${s[1]?s[1]:""}`)},m(l,r){R(l,t,r),h&&h.m(t,null),it(t,i),o&&o.m(t,null),s[7](t),n=!0},p(l,[r]){h&&h.p&&(!n||r&32)&&U(h,f,l,l[5],n?X(f,l[5],r,null):V(l[5]),null),l[0]?o?o.p(l,r):(o=A(l),o.c(),o.m(t,null)):o&&(o.d(1),o=null),(!n||r&2&&e!==(e=`max-w-[900px] w-full py-2 ${l[1]?l[1]:""}`))&&q(t,"class",e)},i(l){n||(nt(h,l),n=!0)},o(l){at(h,l),n=!1},d(l){l&&B(t),h&&h.d(l),o&&o.d(),s[7](null)}}}const gt=100;function dt(s,t,i){let e,n,f;b(s,rt,a=>i(4,e=a)),b(s,S,a=>i(9,n=a)),b(s,y,a=>i(10,f=a));let{$$slots:h={},$$scope:o}=t,{html:l=null}=t,{className:r=null}=t,{tocDataExists:p=!1}=t,c=null,g=[];const N=ut(()=>C(),gt),C=()=>{let a=null,I=null,M=0,D=0,k=0,H=0,L=0,O=0;g.some((T,w)=>{const u=T.getBoundingClientRect().top,m=g[w+1],d=(m==null?void 0:m.getBoundingClientRect().top)??(c==null?void 0:c.getBoundingClientRect().bottom),J=u<0&&(!m||0<d);a===null&&J&&(D=w,a=T,M=u,L=d-u);const K=u<window.innerHeight&&(!m||window.innerHeight<d);if(I===null&&K)return H=w,I=T,k=u,O=d-u,!0});const F=(0-M)/L,W=(window.innerHeight-k)/O,z=e*(F+D),G=e*Math.min(H+W,H+1);_(y,f={top:Math.floor(z),bottom:Math.floor(G)},f)};ft(()=>{if(!(!p||!c)&&c)return _(S,n=!0,n),_(y,f=null,f),g=[...c.querySelectorAll("h1,h2,h3,h4")],document.addEventListener("scroll",N),()=>{}}),ct(()=>{_(S,n=!1,n),document.removeEventListener("scroll",N)});function j(a){Y[a?"unshift":"push"](()=>{c=a,i(2,c)})}return s.$$set=a=>{"html"in a&&i(0,l=a.html),"className"in a&&i(1,r=a.className),"tocDataExists"in a&&i(3,p=a.tocDataExists),"$$scope"in a&&i(5,o=a.$$scope)},s.$$.update=()=>{s.$$.dirty&20&&e&&c&&(g=[...c.querySelectorAll("h1,h2,h3,h4")],C())},[l,r,c,p,e,o,h,j]}class bt extends Z{constructor(t){super(),x(this,t,dt,mt,P,{html:0,className:1,tocDataExists:3})}}export{bt as M,ft as a,wt as g};
