{"type":"data","nodes":[null,{"type":"data","data":[{"html":1,"frontmatter":2,"date":15,"lang":16,"tocData":17},"\u003Cp>We all agree that React is awesome compared to the era\nwhere we all had been suffered from doing Vanilla JavaScript\nto render DOM without JSX, reactive states, and much more.\nThere is no doubt that React has the biggest ecosystem\namong SPA tools, that's why more and more people try to learn\nReact as time goes by.\u003C/p>\n\u003C!--more-->\n\u003Cp>It's my pleasure to use React at home, at work.\nHowever, nothing can be perfect or satisfy everyone on the earth.\nThere are a few things that I really don't like in React.\u003C/p>\n\u003Ch1 id=\"1-States-as-a-Snapshot\">States as a Snapshot\u003C/h1>\n\u003Cp>In React's functional component, you create a state calling \u003Ccode>useState\u003C/code>\nfunction and it returns an array of the state and a setter.\nAnd the state values are from a snapshot right at the moment when a component renders.\nIt does not gurantee the latest state value will be fetched inside states.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>number\u003Cspan class=\"token punctuation\">,\u003C/span> setNumber\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token plain-text\">      \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>h1\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>number\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>h1\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token plain-text\">      \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>button\u003C/span> \u003Cspan class=\"token attr-name\">onClick\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">        \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>number \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">        \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>number \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">      \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">+2\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>button\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Consider the above example component.\nYou might expect clicking the button will set the state to \u003Ccode>2\u003C/code>,\nsince you are calling the setter twice incrementing by \u003Ccode>1\u003C/code>.\nBut \u003Ccode>number\u003C/code> variable, inside function \u003Ccode>App\u003C/code> is from a snapshot.\nIt represents the same value from the same snapshot\nno matter where or how you reference the state.\nBasically the click callback is same as:\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span> \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span> \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is so famous among React developers that even React's brand new\nofficial documents include a section for this: \u003Ca href=\"https://react.dev/learn/state-as-a-snapshot\">https://react.dev/learn/state-as-a-snapshot\u003C/a>\u003C/p>\n\u003Cp>Without knowing this property of React, new React developers might get confused\nwhy it does not work the way they intended.\nBut I think this is not that bad, since it is fair and justice.\nFunctional component is also a JavaScript function.\nA variable does not change as long as you do not directly assign to the variable (\u003Ccode>number += 1\u003C/code>).\nAnd we \u003Cstrong>don't do that\u003C/strong> in React.\nThis might be confusing, but once you understand this, you will get used to it.\u003C/p>\n\u003Cp>If you need the latest state value, pass a callback function inside state setters.\nReact executes the function with parameter set to the latest state value,\nthus letting you get the latest value inside the callback function.\nThis \u003Cem>updater function\u003C/em> pattern is useful if you want the latest value.\u003C/p>\n\u003Cblockquote>\n\u003Cp>\u003Ca href=\"https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state\">https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">num\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> num \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">num\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> num \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"2-States-are-Updated-Asynchronously\">States are Updated Asynchronously\u003C/h1>\n\u003Cp>In React, states are not updated immediately, but asynchronously.\nThis is for performance not to re-render too many times,\nbut it gives programmers too much frustration.\u003C/p>\n\u003C!-- NOTE jekyll cannot handle double braces properly. Thus escape with raw tag. -->\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The above is an example of showing states are updated asynchronously.\nPlace mouse cursor on the first div, and then move it onto the second div.\nWhat will happen? Upon the mouse leaving the first div,\n\u003Ccode>setDidMouseLeave(true)\u003C/code> will be fired.\nRight after that, \u003Ccode>didMouseLeave &#x26;&#x26; setState('YES!')\u003C/code> will be fired immediately,\nright? Since those divs are adjacent to each other.\nAs \u003Ccode>didMouseLeave\u003C/code> is just updated to \u003Ccode>true\u003C/code>, \u003Ccode>state\u003C/code> will be updated.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/example-not-work.gif\" alt=\"example-not-work\">\u003C/p>\n\u003Cp>No, it does not work that way. There is no flaw in our strategy except that\nwe did not consider asynchronous state updates in React.\u003C/p>\n\u003Cp>In previous section, I explained that states inside components are from a snapshot,\nand it also applies here in this example.\nReact does not update states immediately, thus does not re-render immediately.\nWe expected things would go like this:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>onMouseLeave\u003C/code> fires, and the state got a update.\u003C/li>\n\u003Cli>Component re-renders.\u003C/li>\n\u003Cli>\u003Ccode>onMouseEnter\u003C/code> fires, and since \u003Ccode>didMouseLeave\u003C/code> is updated, \u003Ccode>setState(true)\u003C/code> is called.\u003C/li>\n\u003C/ol>\n\u003Cp>But actually things go like this:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>onMouseLeave\u003C/code> fires, and the state got a update.\u003C/li>\n\u003Cli>\u003Ccode>onMouseEnter\u003C/code> fires, and \u003Ccode>didMouseLeave\u003C/code> is updated, but the component did not re-render yet.\n\u003Ccode>didMouseLeave\u003C/code> is still \u003Ccode>false\u003C/code> in the snapshot, thus \u003Ccode>setState(true)\u003C/code> is not called.\u003C/li>\n\u003Cli>\u003Ccode>App\u003C/code> re-renders, new snapshot has arrived, now \u003Ccode>didMouseLeave\u003C/code> is \u003Ccode>true\u003C/code>,\nbut \u003Ccode>mouseenter\u003C/code> event does not fire again.\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Ccode>didMouseLeave\u003C/code> state is \u003Ccode>false\u003C/code> inside \u003Ccode>onMouseEnter\u003C/code> callback.\nThings will be much more clear if we add bunch of console logs in the component.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'render'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseLeave'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'didMouseLeave:'\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> didMouseLeave\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">    didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"23\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"24\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"25\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/react-states-update-async.gif\" alt=\"react-states-update-async\">\u003C/p>\n\u003Cp>Then how can we solve this? To my best knowledge,\nThere is no reliable way to solve this problem,\nwhere you have two different callbacks that one sets a state\nand the other consumes the lastest state value right away.\u003C/p>\n\u003Cp>This kind of things is pretty much frustrating and not easy to understand\nwhy things work this way.\n\u003Cem>\"Why has it not been updated? Did I do something wrong?\"\u003C/em>\nFuthermore, this is also absurd that there is no easy way to solve this problem.\nHowever, I tried to find solutions to this problem.\nSome of the following do not work, and can not work in the future.\u003C/p>\n\u003Ch2 id=\"3-updater-function\">updater function\u003C/h2>\n\u003Cp>I thought the code would work:\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">let\u003C/span> _didMouseLeave\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">value\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">      _didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">      \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'inside updater function'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">      \u003Cspan class=\"token keyword control-flow\">return\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">    _didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseEnter'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The updater function returns the value as it is,\nand a local variable \u003Ccode>_didMouseLeave\u003C/code> gets the latest value.\nAnd we use that variable for the rest of \u003Ccode>onMouseEnter\u003C/code> callback.\u003C/p>\n\u003Cp>But it does not work since the updater function executes\nasynchronously after the \u003Ccode>onMouseEnter\u003C/code> has finished.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/updater-function-not-work.gif\" alt=\"updater-function-not-work\">\u003C/p>\n\u003Cp>I assume it might have something to do with performance.\nWhile executing event callbacks, React does not execute updater functions\nto focus solely on handling events. After all the handlers finish,\nReact calls updater functions for next re-render.\nI don't know. It's all my guess.\u003C/p>\n\u003Ch2 id=\"4-useRef\">\u003Ccode>useRef\u003C/code>\u003C/h2>\n\u003Cp>Use \u003Ccode>useRef\u003C/code> to save \u003Ccode>didMouseLeave\u003C/code>.\nBut be aware that \u003Ccode>ref\u003C/code> changes do not incur re-render.\u003C/p>\n\u003Cblockquote>\n\u003Cp>When you change the ref.current property, React does not re-render your component. React is not aware of when you change it because a ref is a plain JavaScript object.\u003Cbr>\n\u003Ca href=\"https://react.dev/reference/react/useRef#caveats\">https://react.dev/reference/react/useRef#caveats\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState\u003Cspan class=\"token punctuation\">,\u003C/span> useRef \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRef\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>But the above does not 100% resemble the original component.\nThe original component re-render upon solely on first div \u003Ccode>mouseleave\u003C/code> event.\nThis component, does not.\nTo replicate the original component, we need one \u003Ccode>useState\u003C/code> and one \u003Ccode>useRef\u003C/code>\nto save \u003Cstrong>the same state\u003C/strong>.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState\u003Cspan class=\"token punctuation\">,\u003C/span> useRef \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> didMouseLeaveRef \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRef\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>didMouseLeaveRef\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"23\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"24\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>...I really don't like it.\u003Cbr>\nMaybe defining a custom hook that has an \u003Ccode>useState\u003C/code> and an \u003Ccode>useRef\u003C/code>\ncould be a good idea to recycle and refactor the code.\u003C/p>\n\u003C!-- TODO Add flushSync -->\n\u003Ch2 id=\"5-recoil\">\u003Ccode>recoil\u003C/code>\u003C/h2>\n\u003Cp>If you use \u003Ccode>recoil\u003C/code>, at least in \u003Ccode>^0.7.x\u003C/code> versions,\nupdater functions execute synchronously unlike React states.\nBut be aware that I could not find any documentation for this\nthus \u003Cstrong>this behavior may change on future releases\u003C/strong>.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRecoilState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>mouseLeaveAtom\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">    \u003Cspan class=\"token keyword\">let\u003C/span> _didMouseLeave\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">value\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">      _didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">      \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'inside recoil updater function'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">      \u003Cspan class=\"token keyword control-flow\">return\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    _didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseEnter'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/recoil-updater-function-works.gif\" alt=\"recoil-updater-function-works\">\n\u003Cbr>\u003C/p>\n\u003Ch2 id=\"6-Other-SPA-Tools\">Other SPA Tools\u003C/h2>\n\u003Cp>In this section, I compare other SPA frameworks/libraries with the specific example component.\u003C/p>\n\u003Ch3 id=\"7-Svelte\">Svelte\u003C/h3>\n\u003Cp>Svelte just works out of the box.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>script\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token plain-text\">  let didMouseLeave = false;\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token plain-text\">  let state = 'no';\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token plain-text\">  const onMouseLeave = () => {didMouseLeave = true};\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token plain-text\">  const onMouseEnter = () => {didMouseLeave &#x26;&#x26; (state = 'YES!')};\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>script\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">on:\u003C/span>mouseleave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">style:\u003C/span>background-color\u003C/span>\u003Cspan class=\"token attr-value\">\u003Cspan class=\"token punctuation attr-equals\">=\u003C/span>\u003Cspan class=\"token punctuation\">'\u003C/span>yellow\u003Cspan class=\"token punctuation\">'\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token plain-text\">  didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">on:\u003C/span>mouseenter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">style:\u003C/span>background-color\u003C/span>\u003Cspan class=\"token attr-value\">\u003Cspan class=\"token punctuation attr-equals\">=\u003C/span>\u003Cspan class=\"token punctuation\">'\u003C/span>orange\u003Cspan class=\"token punctuation\">'\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">  state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cbr>\n\u003Ch3 id=\"8-SolidJS\">SolidJS\u003C/h3>\n\u003Cp>SolidJS is a SPA framework and it has react-like grammars and syntax but\ndoes not have virtual DOM, or asynchronous updates (though you can if you want).\nReact developers may easily understand SolidJS code without learning it.\nSolidJS works out of the box.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">createSignal\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">createSignal\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token function\">didMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token string-property property\">'background-color'\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token function\">didMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token string-property property\">'background-color'\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token function\">state\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>SolidJS gurantees its granular render/update in its own document.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Solid's reactivity is synchronous which means, by the next line after any change,\nthe DOM will have updated. And for the most part this is perfectly fine,\nas Solid's granular rendering is just a propagation of the update in the reactive system.\n\u003Ca href=\"https://www.solidjs.com/tutorial/reactivity_batch\">https://www.solidjs.com/tutorial/reactivity_batch\u003C/a>\u003C/p>\n\u003C/blockquote>",{"layout":3,"toc":4,"math":5,"title":6,"category":7,"tags":9,"author":13},"post",true,false,"What I don't like in React",[8],"Programming",[10,11,12],"web","react","javascript",[14],"","2023-03-31","eng",[18,22,25,29,32,35,38,42],{"depth":19,"id":20,"text":21},1,"1-States-as-a-Snapshot","States as a Snapshot",{"depth":19,"id":23,"text":24},"2-States-are-Updated-Asynchronously","States are Updated Asynchronously",{"depth":26,"id":27,"text":28},2,"3-updater-function","updater function",{"depth":26,"id":30,"text":31},"4-useRef","useRef",{"depth":26,"id":33,"text":34},"5-recoil","recoil",{"depth":26,"id":36,"text":37},"6-Other-SPA-Tools","Other SPA Tools",{"depth":39,"id":40,"text":41},3,"7-Svelte","Svelte",{"depth":39,"id":43,"text":44},"8-SolidJS","SolidJS"],"uses":{"params":["year","slug"]}}]}
