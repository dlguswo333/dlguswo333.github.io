<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../favicon.ico" />
		<meta name="viewport" content="width=device-width" />
		
		<link href="../../_app/immutable/assets/0.2e853844.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.f884c089.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/scheduler.db0ac06a.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/singletons.2c0c51b2.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.1bcf888f.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.546e4740.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.4a49f625.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.cd5a136d.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.a82faf3f.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/GithubMark.58026925.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/store.53f04f50.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/5.7e60752c.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/each.e59479a4.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/Category.4215e0eb.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/MainSection.a957b41b.js"><title>What I don't like in React : dlguswo333&#39;s blog</title><!-- HEAD_svelte-etxm8u_START --><!-- HEAD_svelte-etxm8u_END -->
		<!-- [TODO] For portability I can erase the following elements and inject them from index.ts when building? -->
		<title>dlguswo333's Blog</title>
		<meta name="google-site-verification" content="GIhlBkE7qu5AWLVmQ4w2lBcxEw-AumQhdQf_2zR2X4s" />
	</head>
	<body data-sveltekit-preload-data="hover">
		<script>
			const systemTheme= window.matchMedia('(prefers-color-scheme:dark)').matches ? 'dark' : 'light';
			const rootElement = document.querySelector('body');
			try {
				const storedValue = JSON.parse(localStorage.getItem('color-theme') || 'null');
				const currentTheme = storedValue === 'light' || storedValue === 'dark' ? storedValue : systemTheme;
				if(rootElement) {
  				rootElement.classList.add(currentTheme);
				}
			} catch {
				rootElement.classList.add(systemTheme);
			}
		</script>
		<div id="root">  <header class="p-2 sticky top-0 flex flex-row items-center justify-between border-b border-b-gray-300 bg-gray-50 dark:bg-[#2c3039] dark:border-b-gray-700"><div class="flex flex-row items-center gap-1"> <a href="/" class="inline-block h-8 w-8" data-svelte-h="svelte-htzscq"><span class="hidden">Go To Home</span> <img src="/favicon.svg" alt="Logo"></a> <button type="button" title="Toggle color theme" class="group"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="h-8 w-8 transition"><rect x="3" y="3" width="94" height="94" stroke-width="6" rx="16" ry="16" class="stroke-gray-600 fill-none"></rect></svg></button> </div> <div class="flex flex-row items-center"><a href="/categories" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Categories</a> <a href="/tags" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Tags</a> <a href="/about" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">About</a></div></header>  <div class="flex flex-row flex-grow justify-center p-2 lg:p-0 lg:pr-[300px]"> <aside class="w-[300px] overflow-hidden hidden mt-10 self-start md:!flex md:sticky md:top-14 flex-col justify-center items-center p-3
  "><ul class="w-full max-h-[80vh] overflow-auto"><li title="States as a Snapshot" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-bold  
        " style="padding-left: 0.3rem;"><a href="#1-States-as-a-Snapshot" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">States as a Snapshot</a> </li><li title="States are Updated Asynchronously" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 font-bold  
        " style="padding-left: 0.3rem;"><a href="#2-States-are-Updated-Asynchronously" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">States are Updated Asynchronously</a> </li><li title="updater function" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 0.9666666666666666rem;"><a href="#3-updater-function" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">updater function</a> </li><li title="useRef" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 0.9666666666666666rem;"><a href="#4-useRef" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">useRef</a> </li><li title="recoil" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 0.9666666666666666rem;"><a href="#5-recoil" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">recoil</a> </li><li title="Other SPA Tools" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 0.9666666666666666rem;"><a href="#6-Other-SPA-Tools" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">Other SPA Tools</a> </li><li title="Svelte" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 1.6333333333333333rem;"><a href="#7-Svelte" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">Svelte</a> </li><li title="SolidJS" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700   
        " style="padding-left: 1.6333333333333333rem;"><a href="#8-SolidJS" class="whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow">SolidJS</a> </li></ul></aside>  <div class="flex flex-col justify-center min-w-0"><div class="max-w-[900px] flex flex-col items-center py-6 gap-3"><h1 class="text-4xl font-bold text-center">What I don't like in React</h1> <span>2023-03-31 </span> <button class="px-2 py-0.5 rounded-lg shadow-md shadow-emerald-50 border-l-slate-100 bg-sky-300 text-white hover:bg-sky-500 dark:shadow-emerald-900 transition">/Programming</button> <div><button class="last:mr-0 bg-green-100 hover:bg-green-400 hover:text-white dark:text-black transition px-2 py-0.5 rounded-xl shadow-md dark:shadow-green-900" style="margin-right: 0.25rem; margin-left: 0.5rem">#web</button><button class="last:mr-0 bg-green-100 hover:bg-green-400 hover:text-white dark:text-black transition px-2 py-0.5 rounded-xl shadow-md dark:shadow-green-900" style="margin-right: 0.25rem; margin-left: 0rem">#react</button><button class="last:mr-0 bg-green-100 hover:bg-green-400 hover:text-white dark:text-black transition px-2 py-0.5 rounded-xl shadow-md dark:shadow-green-900" style="margin-right: 0.25rem; margin-left: 0rem">#javascript</button></div></div> <hr class="bg-gray-400 my-4">  <main class="max-w-[900px] w-full py-2 post"> <!-- HTML_TAG_START --><p>We all agree that React is awesome compared to the era
where we all had been suffered from doing Vanilla JavaScript
to render DOM without JSX, reactive states, and much more.
There is no doubt that React has the biggest ecosystem
among SPA tools, that's why more and more people try to learn
React as time goes by.</p>
<!--more-->
<p>It's my pleasure to use React at home, at work.
However, nothing can be perfect or satisfy everyone on the earth.
There are a few things that I really don't like in React.</p>
<h1 id="1-States-as-a-Snapshot">States as a Snapshot</h1>
<p>In React's functional component, you create a state calling <code>useState</code>
function and it returns an array of the state and a setter.
And the state values are from a snapshot right at the moment when a component renders.
It does not gurantee the latest state value will be fetched inside states.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> <span class="token punctuation">[</span>number<span class="token punctuation">,</span> setNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6">  <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
</span><span class="code-line line-number" line="7">    <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="8"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>h1</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="9"><span class="token plain-text">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span></span></span><span class="code-line line-number" line="10"><span class="token tag"><span class="token script language-javascript">        <span class="token function">setNumber</span><span class="token punctuation">(</span>number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span></span><span class="code-line line-number" line="11"><span class="token tag"><span class="token script language-javascript">        <span class="token function">setNumber</span><span class="token punctuation">(</span>number <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></span></span><span class="code-line line-number" line="12"><span class="token tag"><span class="token script language-javascript">      <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">+2</span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>button</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="14">  <span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15"><span class="token punctuation">}</span>
</span></code></pre>
<p>Consider the above example component.
You might expect clicking the button will set the state to <code>2</code>,
since you are calling the setter twice incrementing by <code>1</code>.
But <code>number</code> variable, inside function <code>App</code> is from a snapshot.
It represents the same value from the same snapshot
no matter where or how you reference the state.
Basically the click callback is same as:</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1">  <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">  <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>This is so famous among React developers that even React's brand new
official documents include a section for this: <a href="https://react.dev/learn/state-as-a-snapshot">https://react.dev/learn/state-as-a-snapshot</a></p>
<p>Without knowing this property of React, new React developers might get confused
why it does not work the way they intended.
But I think this is not that bad, since it is fair and justice.
Functional component is also a JavaScript function.
A variable does not change as long as you do not directly assign to the variable (<code>number += 1</code>).
And we <strong>don't do that</strong> in React.
This might be confusing, but once you understand this, you will get used to it.</p>
<p>If you need the latest state value, pass a callback function inside state setters.
React executes the function with parameter set to the latest state value,
thus letting you get the latest value inside the callback function.
This <em>updater function</em> pattern is useful if you want the latest value.</p>
<blockquote>
<p><a href="https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state">https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state</a></p>
</blockquote>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1">  <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token arrow operator">=></span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">  <span class="token function">setNumber</span><span class="token punctuation">(</span><span class="token parameter">num</span> <span class="token arrow operator">=></span> num <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h1 id="2-States-are-Updated-Asynchronously">States are Updated Asynchronously</h1>
<p>In React, states are not updated immediately, but asynchronously.
This is for performance not to re-render too many times,
but it gives programmers too much frustration.</p>
<!-- NOTE jekyll cannot handle double braces properly. Thus escape with raw tag. -->
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> <span class="token punctuation">[</span>didMouseLeave<span class="token punctuation">,</span> setDidMouseLeave<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> didMouseLeave <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">
</span><span class="code-line line-number" line="10">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="11"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseLeave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="12"><span class="token plain-text">      didMouseLeave: </span><span class="token punctuation">{</span>didMouseLeave <span class="token operator">?</span> <span class="token string">'true'</span> <span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">      state: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span></code></pre>
<p>The above is an example of showing states are updated asynchronously.
Place mouse cursor on the first div, and then move it onto the second div.
What will happen? Upon the mouse leaving the first div,
<code>setDidMouseLeave(true)</code> will be fired.
Right after that, <code>didMouseLeave &#x26;&#x26; setState('YES!')</code> will be fired immediately,
right? Since those divs are adjacent to each other.
As <code>didMouseLeave</code> is just updated to <code>true</code>, <code>state</code> will be updated.</p>
<p><img src="/img/2023-03-31-what-i-dont-like-in-react/example-not-work.gif" alt="example-not-work"></p>
<p>No, it does not work that way. There is no flaw in our strategy except that
we did not consider asynchronous state updates in React.</p>
<p>In previous section, I explained that states inside components are from a snapshot,
and it also applies here in this example.
React does not update states immediately, thus does not re-render immediately.
We expected things would go like this:</p>
<ol>
<li><code>onMouseLeave</code> fires, and the state got a update.</li>
<li>Component re-renders.</li>
<li><code>onMouseEnter</code> fires, and since <code>didMouseLeave</code> is updated, <code>setState(true)</code> is called.</li>
</ol>
<p>But actually things go like this:</p>
<ol>
<li><code>onMouseLeave</code> fires, and the state got a update.</li>
<li><code>onMouseEnter</code> fires, and <code>didMouseLeave</code> is updated, but the component did not re-render yet.
<code>didMouseLeave</code> is still <code>false</code> in the snapshot, thus <code>setState(true)</code> is not called.</li>
<li><code>App</code> re-renders, new snapshot has arrived, now <code>didMouseLeave</code> is <code>true</code>,
but <code>mouseenter</code> event does not fire again.</li>
</ol>
<p><code>didMouseLeave</code> state is <code>false</code> inside <code>onMouseEnter</code> callback.
Things will be much more clear if we add bunch of console logs in the component.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'render'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token punctuation">[</span>didMouseLeave<span class="token punctuation">,</span> setDidMouseLeave<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'onMouseLeave'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">    <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'didMouseLeave:'</span><span class="token punctuation">,</span> didMouseLeave<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">    didMouseLeave <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="15">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="16">
</span><span class="code-line line-number" line="17">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseLeave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">      didMouseLeave: </span><span class="token punctuation">{</span>didMouseLeave <span class="token operator">?</span> <span class="token string">'true'</span> <span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="22"><span class="token plain-text">      state: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="23"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="24"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="25"><span class="token punctuation">}</span>
</span></code></pre>
<p><img src="/img/2023-03-31-what-i-dont-like-in-react/react-states-update-async.gif" alt="react-states-update-async"></p>
<p>Then how can we solve this? To my best knowledge,
There is no reliable way to solve this problem,
where you have two different callbacks that one sets a state
and the other consumes the lastest state value right away.</p>
<p>This kind of things is pretty much frustrating and not easy to understand
why things work this way.
<em>"Why has it not been updated? Did I do something wrong?"</em>
Futhermore, this is also absurd that there is no easy way to solve this problem.
However, I tried to find solutions to this problem.
Some of the following do not work, and can not work in the future.</p>
<h2 id="3-updater-function">updater function</h2>
<p>I thought the code would work:</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">let</span> _didMouseLeave<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">    <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">      _didMouseLeave <span class="token operator">=</span> value<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'inside updater function'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">      <span class="token keyword control-flow">return</span> value<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="8">    _didMouseLeave <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'onMouseEnter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">  <span class="token punctuation">}</span>
</span></code></pre>
<p>The updater function returns the value as it is,
and a local variable <code>_didMouseLeave</code> gets the latest value.
And we use that variable for the rest of <code>onMouseEnter</code> callback.</p>
<p>But it does not work since the updater function executes
asynchronously after the <code>onMouseEnter</code> has finished.</p>
<p><img src="/img/2023-03-31-what-i-dont-like-in-react/updater-function-not-work.gif" alt="updater-function-not-work"></p>
<p>I assume it might have something to do with performance.
While executing event callbacks, React does not execute updater functions
to focus solely on handling events. After all the handlers finish,
React calls updater functions for next re-render.
I don't know. It's all my guess.</p>
<h2 id="4-useRef"><code>useRef</code></h2>
<p>Use <code>useRef</code> to save <code>didMouseLeave</code>.
But be aware that <code>ref</code> changes do not incur re-render.</p>
<blockquote>
<p>When you change the ref.current property, React does not re-render your component. React is not aware of when you change it because a ref is a plain JavaScript object.<br>
<a href="https://react.dev/reference/react/useRef#caveats">https://react.dev/reference/react/useRef#caveats</a></p>
</blockquote>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> didMouseLeave <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="8">    didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="10">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">    didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="13">
</span><span class="code-line line-number" line="14">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseLeave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">      didMouseLeave: </span><span class="token punctuation">{</span>didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">?</span> <span class="token string">'true'</span> <span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">      state: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="22"><span class="token punctuation">}</span>
</span></code></pre>
<p>But the above does not 100% resemble the original component.
The original component re-render upon solely on first div <code>mouseleave</code> event.
This component, does not.
To replicate the original component, we need one <code>useState</code> and one <code>useRef</code>
to save <strong>the same state</strong>.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> useState<span class="token punctuation">,</span> useRef <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">const</span> didMouseLeaveRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token punctuation">[</span>didMouseLeave<span class="token punctuation">,</span> setDidMouseLeave<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>didMouseLeaveRef<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">
</span><span class="code-line line-number" line="8">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">    <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span>didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="12">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="13">    didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="14">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="15">
</span><span class="code-line line-number" line="16">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseLeave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">      didMouseLeave: </span><span class="token punctuation">{</span>didMouseLeave<span class="token punctuation">.</span><span class="token property-access">current</span> <span class="token operator">?</span> <span class="token string">'true'</span> <span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="20"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token literal-property property">backgroundColor</span><span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="21"><span class="token plain-text">      state: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="22"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="23"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="24"><span class="token punctuation">}</span>
</span></code></pre>
<p>...I really don't like it.<br>
Maybe defining a custom hook that has an <code>useState</code> and an <code>useRef</code>
could be a good idea to recycle and refactor the code.</p>
<!-- TODO Add flushSync -->
<h2 id="5-recoil"><code>recoil</code></h2>
<p>If you use <code>recoil</code>, at least in <code>^0.7.x</code> versions,
updater functions execute synchronously unlike React states.
But be aware that I could not find any documentation for this
thus <strong>this behavior may change on future releases</strong>.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1">  <span class="token keyword">const</span> <span class="token punctuation">[</span>didMouseLeave<span class="token punctuation">,</span> setDidMouseLeave<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useRecoilState</span><span class="token punctuation">(</span>mouseLeaveAtom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token keyword">let</span> _didMouseLeave<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">    <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span><span class="token parameter">value</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">      _didMouseLeave <span class="token operator">=</span> value<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">      <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'inside recoil updater function'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8">      <span class="token keyword control-flow">return</span> value<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="9">    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">    _didMouseLeave <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'onMouseEnter'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="12">  <span class="token punctuation">}</span>
</span></code></pre>
<p><img src="/img/2023-03-31-what-i-dont-like-in-react/recoil-updater-function-works.gif" alt="recoil-updater-function-works">
<br></p>
<h2 id="6-Other-SPA-Tools">Other SPA Tools</h2>
<p>In this section, I compare other SPA frameworks/libraries with the specific example component.</p>
<h3 id="7-Svelte">Svelte</h3>
<p>Svelte just works out of the box.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>script</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="2"><span class="token plain-text">  let didMouseLeave = false;
</span></span><span class="code-line line-number" line="3"><span class="token plain-text">  let state = 'no';
</span></span><span class="code-line line-number" line="4"><span class="token plain-text">
</span></span><span class="code-line line-number" line="5"><span class="token plain-text">  const onMouseLeave = () => {didMouseLeave = true};
</span></span><span class="code-line line-number" line="6"><span class="token plain-text">  const onMouseEnter = () => {didMouseLeave &#x26;&#x26; (state = 'YES!')};
</span></span><span class="code-line line-number" line="7"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>script</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name"><span class="token namespace">on:</span>mouseleave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name"><span class="token namespace">style:</span>background-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>yellow<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="10"><span class="token plain-text">  didMouseLeave: </span><span class="token punctuation">{</span>didMouseLeave<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="11"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span><span class="code-line line-number" line="12"><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name"><span class="token namespace">on:</span>mouseenter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name"><span class="token namespace">style:</span>background-color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">'</span>orange<span class="token punctuation">'</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">  state: </span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span>
</span></code></pre>
<br>
<h3 id="8-SolidJS">SolidJS</h3>
<p>SolidJS is a SPA framework and it has react-like grammars and syntax but
does not have virtual DOM, or asynchronous updates (though you can if you want).
React developers may easily understand SolidJS code without learning it.
SolidJS works out of the box.</p>
<pre class="language-jsx"><code class="language-jsx code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function"><span class="token maybe-class-name">App</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">const</span> <span class="token punctuation">[</span>didMouseLeave<span class="token punctuation">,</span> setDidMouseLeave<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">createSignal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3">  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> setState<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">createSignal</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseLeave</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    <span class="token function">setDidMouseLeave</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">  <span class="token keyword">const</span> <span class="token function-variable function">onMouseEnter</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="9">    <span class="token function">didMouseLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&#x26;&#x26;</span> <span class="token function">setState</span><span class="token punctuation">(</span><span class="token string">'YES!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12">  <span class="token keyword control-flow">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="13"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseLeave</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseLeave<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string-property property">'background-color'</span><span class="token operator">:</span> <span class="token string">'yellow'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="14"><span class="token plain-text">      didMouseLeave: </span><span class="token punctuation">{</span><span class="token function">didMouseLeave</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'true'</span> <span class="token operator">:</span> <span class="token string">'false'</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="15"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="16"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;</span>div</span> <span class="token attr-name">onMouseEnter</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onMouseEnter<span class="token punctuation">}</span></span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string-property property">'background-color'</span><span class="token operator">:</span> <span class="token string">'orange'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="17"><span class="token plain-text">      state: </span><span class="token punctuation">{</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
</span></span><span class="code-line line-number" line="18"><span class="token plain-text">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span>div</span><span class="token punctuation">></span></span><span class="token plain-text">
</span></span><span class="code-line line-number" line="19"><span class="token plain-text">  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&#x3C;/</span></span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="20"><span class="token punctuation">}</span>
</span></code></pre>
<p>SolidJS gurantees its granular render/update in its own document.</p>
<blockquote>
<p>Solid's reactivity is synchronous which means, by the next line after any change,
the DOM will have updated. And for the most part this is perfectly fine,
as Solid's granular rendering is just a propagation of the update in the reactive system.
<a href="https://www.solidjs.com/tutorial/reactivity_batch">https://www.solidjs.com/tutorial/reactivity_batch</a></p>
</blockquote><!-- HTML_TAG_END --></main></div></div> <footer class="p-2 py-5 text-sm flex gap-1 flex-col md:flex-row items-center justify-between border-t border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-[#2c3039]"><div> 2021~2023 dlguswo333; All rights reserved.</div> <div class="flex items-center"><a class="inline-flex items-center" href="https://github.com/dlguswo333/dlguswo333.github.io"><img class="inline h-4 w-4 mr-1" src="/github-mark.svg" alt="github-mark"></a>
    Built with Sveltekit.</div></footer>  
			
			<script>
				{
					__sveltekit_9fvm1m = {
						base: new URL("../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{html:"\u003Cp>We all agree that React is awesome compared to the era\nwhere we all had been suffered from doing Vanilla JavaScript\nto render DOM without JSX, reactive states, and much more.\nThere is no doubt that React has the biggest ecosystem\namong SPA tools, that's why more and more people try to learn\nReact as time goes by.\u003C/p>\n\u003C!--more-->\n\u003Cp>It's my pleasure to use React at home, at work.\nHowever, nothing can be perfect or satisfy everyone on the earth.\nThere are a few things that I really don't like in React.\u003C/p>\n\u003Ch1 id=\"1-States-as-a-Snapshot\">States as a Snapshot\u003C/h1>\n\u003Cp>In React's functional component, you create a state calling \u003Ccode>useState\u003C/code>\nfunction and it returns an array of the state and a setter.\nAnd the state values are from a snapshot right at the moment when a component renders.\nIt does not gurantee the latest state value will be fetched inside states.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>number\u003Cspan class=\"token punctuation\">,\u003C/span> setNumber\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token plain-text\">      \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>h1\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>number\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>h1\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token plain-text\">      \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>button\u003C/span> \u003Cspan class=\"token attr-name\">onClick\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">        \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>number \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">        \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>number \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token script language-javascript\">      \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">+2\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>button\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Consider the above example component.\nYou might expect clicking the button will set the state to \u003Ccode>2\u003C/code>,\nsince you are calling the setter twice incrementing by \u003Ccode>1\u003C/code>.\nBut \u003Ccode>number\u003C/code> variable, inside function \u003Ccode>App\u003C/code> is from a snapshot.\nIt represents the same value from the same snapshot\nno matter where or how you reference the state.\nBasically the click callback is same as:\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span> \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token number\">0\u003C/span> \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is so famous among React developers that even React's brand new\nofficial documents include a section for this: \u003Ca href=\"https://react.dev/learn/state-as-a-snapshot\">https://react.dev/learn/state-as-a-snapshot\u003C/a>\u003C/p>\n\u003Cp>Without knowing this property of React, new React developers might get confused\nwhy it does not work the way they intended.\nBut I think this is not that bad, since it is fair and justice.\nFunctional component is also a JavaScript function.\nA variable does not change as long as you do not directly assign to the variable (\u003Ccode>number += 1\u003C/code>).\nAnd we \u003Cstrong>don't do that\u003C/strong> in React.\nThis might be confusing, but once you understand this, you will get used to it.\u003C/p>\n\u003Cp>If you need the latest state value, pass a callback function inside state setters.\nReact executes the function with parameter set to the latest state value,\nthus letting you get the latest value inside the callback function.\nThis \u003Cem>updater function\u003C/em> pattern is useful if you want the latest value.\u003C/p>\n\u003Cblockquote>\n\u003Cp>\u003Ca href=\"https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state\">https://react.dev/reference/react/useState#updating-state-based-on-the-previous-state\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">num\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> num \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token function\">setNumber\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">num\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> num \u003Cspan class=\"token operator\">+\u003C/span> \u003Cspan class=\"token number\">1\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"2-States-are-Updated-Asynchronously\">States are Updated Asynchronously\u003C/h1>\n\u003Cp>In React, states are not updated immediately, but asynchronously.\nThis is for performance not to re-render too many times,\nbut it gives programmers too much frustration.\u003C/p>\n\u003C!-- NOTE jekyll cannot handle double braces properly. Thus escape with raw tag. -->\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The above is an example of showing states are updated asynchronously.\nPlace mouse cursor on the first div, and then move it onto the second div.\nWhat will happen? Upon the mouse leaving the first div,\n\u003Ccode>setDidMouseLeave(true)\u003C/code> will be fired.\nRight after that, \u003Ccode>didMouseLeave &#x26;&#x26; setState('YES!')\u003C/code> will be fired immediately,\nright? Since those divs are adjacent to each other.\nAs \u003Ccode>didMouseLeave\u003C/code> is just updated to \u003Ccode>true\u003C/code>, \u003Ccode>state\u003C/code> will be updated.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/example-not-work.gif\" alt=\"example-not-work\">\u003C/p>\n\u003Cp>No, it does not work that way. There is no flaw in our strategy except that\nwe did not consider asynchronous state updates in React.\u003C/p>\n\u003Cp>In previous section, I explained that states inside components are from a snapshot,\nand it also applies here in this example.\nReact does not update states immediately, thus does not re-render immediately.\nWe expected things would go like this:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>onMouseLeave\u003C/code> fires, and the state got a update.\u003C/li>\n\u003Cli>Component re-renders.\u003C/li>\n\u003Cli>\u003Ccode>onMouseEnter\u003C/code> fires, and since \u003Ccode>didMouseLeave\u003C/code> is updated, \u003Ccode>setState(true)\u003C/code> is called.\u003C/li>\n\u003C/ol>\n\u003Cp>But actually things go like this:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>onMouseLeave\u003C/code> fires, and the state got a update.\u003C/li>\n\u003Cli>\u003Ccode>onMouseEnter\u003C/code> fires, and \u003Ccode>didMouseLeave\u003C/code> is updated, but the component did not re-render yet.\n\u003Ccode>didMouseLeave\u003C/code> is still \u003Ccode>false\u003C/code> in the snapshot, thus \u003Ccode>setState(true)\u003C/code> is not called.\u003C/li>\n\u003Cli>\u003Ccode>App\u003C/code> re-renders, new snapshot has arrived, now \u003Ccode>didMouseLeave\u003C/code> is \u003Ccode>true\u003C/code>,\nbut \u003Ccode>mouseenter\u003C/code> event does not fire again.\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Ccode>didMouseLeave\u003C/code> state is \u003Ccode>false\u003C/code> inside \u003Ccode>onMouseEnter\u003C/code> callback.\nThings will be much more clear if we add bunch of console logs in the component.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'render'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseLeave'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'didMouseLeave:'\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> didMouseLeave\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">    didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"23\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"24\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"25\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/react-states-update-async.gif\" alt=\"react-states-update-async\">\u003C/p>\n\u003Cp>Then how can we solve this? To my best knowledge,\nThere is no reliable way to solve this problem,\nwhere you have two different callbacks that one sets a state\nand the other consumes the lastest state value right away.\u003C/p>\n\u003Cp>This kind of things is pretty much frustrating and not easy to understand\nwhy things work this way.\n\u003Cem>\"Why has it not been updated? Did I do something wrong?\"\u003C/em>\nFuthermore, this is also absurd that there is no easy way to solve this problem.\nHowever, I tried to find solutions to this problem.\nSome of the following do not work, and can not work in the future.\u003C/p>\n\u003Ch2 id=\"3-updater-function\">updater function\u003C/h2>\n\u003Cp>I thought the code would work:\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">let\u003C/span> _didMouseLeave\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">value\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">      _didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">      \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'inside updater function'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">      \u003Cspan class=\"token keyword control-flow\">return\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">    _didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseEnter'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The updater function returns the value as it is,\nand a local variable \u003Ccode>_didMouseLeave\u003C/code> gets the latest value.\nAnd we use that variable for the rest of \u003Ccode>onMouseEnter\u003C/code> callback.\u003C/p>\n\u003Cp>But it does not work since the updater function executes\nasynchronously after the \u003Ccode>onMouseEnter\u003C/code> has finished.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/updater-function-not-work.gif\" alt=\"updater-function-not-work\">\u003C/p>\n\u003Cp>I assume it might have something to do with performance.\nWhile executing event callbacks, React does not execute updater functions\nto focus solely on handling events. After all the handlers finish,\nReact calls updater functions for next re-render.\nI don't know. It's all my guess.\u003C/p>\n\u003Ch2 id=\"4-useRef\">\u003Ccode>useRef\u003C/code>\u003C/h2>\n\u003Cp>Use \u003Ccode>useRef\u003C/code> to save \u003Ccode>didMouseLeave\u003C/code>.\nBut be aware that \u003Ccode>ref\u003C/code> changes do not incur re-render.\u003C/p>\n\u003Cblockquote>\n\u003Cp>When you change the ref.current property, React does not re-render your component. React is not aware of when you change it because a ref is a plain JavaScript object.\u003Cbr>\n\u003Ca href=\"https://react.dev/reference/react/useRef#caveats\">https://react.dev/reference/react/useRef#caveats\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState\u003Cspan class=\"token punctuation\">,\u003C/span> useRef \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRef\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>But the above does not 100% resemble the original component.\nThe original component re-render upon solely on first div \u003Ccode>mouseleave\u003C/code> event.\nThis component, does not.\nTo replicate the original component, we need one \u003Ccode>useState\u003C/code> and one \u003Ccode>useRef\u003C/code>\nto save \u003Cstrong>the same state\u003C/strong>.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword module\">import\u003C/span> \u003Cspan class=\"token imports\">\u003Cspan class=\"token punctuation\">{\u003C/span> useState\u003Cspan class=\"token punctuation\">,\u003C/span> useRef \u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token keyword module\">from\u003C/span> \u003Cspan class=\"token string\">'react'\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword module\">export\u003C/span> \u003Cspan class=\"token keyword module\">default\u003C/span> \u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">const\u003C/span> didMouseLeaveRef \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRef\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>didMouseLeaveRef\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">    didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token property-access\">current\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token literal-property property\">backgroundColor\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"21\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"22\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"23\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"24\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>...I really don't like it.\u003Cbr>\nMaybe defining a custom hook that has an \u003Ccode>useState\u003C/code> and an \u003Ccode>useRef\u003C/code>\ncould be a good idea to recycle and refactor the code.\u003C/p>\n\u003C!-- TODO Add flushSync -->\n\u003Ch2 id=\"5-recoil\">\u003Ccode>recoil\u003C/code>\u003C/h2>\n\u003Cp>If you use \u003Ccode>recoil\u003C/code>, at least in \u003Ccode>^0.7.x\u003C/code> versions,\nupdater functions execute synchronously unlike React states.\nBut be aware that I could not find any documentation for this\nthus \u003Cstrong>this behavior may change on future releases\u003C/strong>.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">useRecoilState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>mouseLeaveAtom\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">    \u003Cspan class=\"token keyword\">let\u003C/span> _didMouseLeave\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token parameter\">value\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">      _didMouseLeave \u003Cspan class=\"token operator\">=\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">      \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'inside recoil updater function'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">      \u003Cspan class=\"token keyword control-flow\">return\u003C/span> value\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    _didMouseLeave \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">    \u003Cspan class=\"token console class-name\">console\u003C/span>\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token method function property-access\">log\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'onMouseEnter'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2023-03-31-what-i-dont-like-in-react/recoil-updater-function-works.gif\" alt=\"recoil-updater-function-works\">\n\u003Cbr>\u003C/p>\n\u003Ch2 id=\"6-Other-SPA-Tools\">Other SPA Tools\u003C/h2>\n\u003Cp>In this section, I compare other SPA frameworks/libraries with the specific example component.\u003C/p>\n\u003Ch3 id=\"7-Svelte\">Svelte\u003C/h3>\n\u003Cp>Svelte just works out of the box.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>script\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token plain-text\">  let didMouseLeave = false;\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token plain-text\">  let state = 'no';\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token plain-text\">  const onMouseLeave = () => {didMouseLeave = true};\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token plain-text\">  const onMouseEnter = () => {didMouseLeave &#x26;&#x26; (state = 'YES!')};\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>script\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">on:\u003C/span>mouseleave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">style:\u003C/span>background-color\u003C/span>\u003Cspan class=\"token attr-value\">\u003Cspan class=\"token punctuation attr-equals\">=\u003C/span>\u003Cspan class=\"token punctuation\">'\u003C/span>yellow\u003Cspan class=\"token punctuation\">'\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token plain-text\">  didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">on:\u003C/span>mouseenter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">\u003Cspan class=\"token namespace\">style:\u003C/span>background-color\u003C/span>\u003Cspan class=\"token attr-value\">\u003Cspan class=\"token punctuation attr-equals\">=\u003C/span>\u003Cspan class=\"token punctuation\">'\u003C/span>orange\u003Cspan class=\"token punctuation\">'\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">  state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>state\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">\u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cbr>\n\u003Ch3 id=\"8-SolidJS\">SolidJS\u003C/h3>\n\u003Cp>SolidJS is a SPA framework and it has react-like grammars and syntax but\ndoes not have virtual DOM, or asynchronous updates (though you can if you want).\nReact developers may easily understand SolidJS code without learning it.\nSolidJS works out of the box.\u003C/p>\n\u003Cpre class=\"language-jsx\">\u003Ccode class=\"language-jsx code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">\u003Cspan class=\"token maybe-class-name\">App\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>didMouseLeave\u003Cspan class=\"token punctuation\">,\u003C/span> setDidMouseLeave\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">createSignal\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token punctuation\">[\u003C/span>state\u003Cspan class=\"token punctuation\">,\u003C/span> setState\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">createSignal\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'no'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseLeave\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token function\">setDidMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">  \u003Cspan class=\"token keyword\">const\u003C/span> \u003Cspan class=\"token function-variable function\">onMouseEnter\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token arrow operator\">=>\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token function\">didMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token function\">setState\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'YES!'\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">  \u003Cspan class=\"token keyword control-flow\">return\u003C/span> \u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseLeave\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseLeave\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token string-property property\">'background-color'\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'yellow'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">\u003Cspan class=\"token plain-text\">      didMouseLeave: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token function\">didMouseLeave\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">?\u003C/span> \u003Cspan class=\"token string\">'true'\u003C/span> \u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'false'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;\u003C/span>div\u003C/span> \u003Cspan class=\"token attr-name\">onMouseEnter\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>onMouseEnter\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span> \u003Cspan class=\"token attr-name\">style\u003C/span>\u003Cspan class=\"token script language-javascript\">\u003Cspan class=\"token script-punctuation punctuation\">=\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token string-property property\">'background-color'\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token string\">'orange'\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">\u003Cspan class=\"token plain-text\">      state: \u003C/span>\u003Cspan class=\"token punctuation\">{\u003C/span>\u003Cspan class=\"token function\">state\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">}\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token plain-text\">    \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>div\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token plain-text\">\n\u003C/span>\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"19\">\u003Cspan class=\"token plain-text\">  \u003C/span>\u003Cspan class=\"token tag\">\u003Cspan class=\"token tag\">\u003Cspan class=\"token punctuation\">&#x3C;/\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">>\u003C/span>\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"20\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>SolidJS gurantees its granular render/update in its own document.\u003C/p>\n\u003Cblockquote>\n\u003Cp>Solid's reactivity is synchronous which means, by the next line after any change,\nthe DOM will have updated. And for the most part this is perfectly fine,\nas Solid's granular rendering is just a propagation of the update in the reactive system.\n\u003Ca href=\"https://www.solidjs.com/tutorial/reactivity_batch\">https://www.solidjs.com/tutorial/reactivity_batch\u003C/a>\u003C/p>\n\u003C/blockquote>",frontmatter:{layout:"post",toc:true,math:false,title:"What I don't like in React",category:["Programming"],tags:["web","react","javascript"],author:[""]},date:"2023-03-31",lang:"en",tocData:[{depth:1,id:"1-States-as-a-Snapshot",text:"States as a Snapshot"},{depth:1,id:"2-States-are-Updated-Asynchronously",text:"States are Updated Asynchronously"},{depth:2,id:"3-updater-function",text:"updater function"},{depth:2,id:"4-useRef",text:"useRef"},{depth:2,id:"5-recoil",text:"recoil"},{depth:2,id:"6-Other-SPA-Tools",text:"Other SPA Tools"},{depth:3,id:"7-Svelte",text:"Svelte"},{depth:3,id:"8-SolidJS",text:"SolidJS"}]},"uses":{"params":["year","slug"]}}];

					Promise.all([
						import("../../_app/immutable/entry/start.f884c089.js"),
						import("../../_app/immutable/entry/app.546e4740.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
