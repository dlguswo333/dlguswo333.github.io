<!DOCTYPE html>
<html lang="ko">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../favicon.ico" />
		<meta name="viewport" content="width=device-width" />
		
		<link href="../../../_app/immutable/assets/0.2925157e.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.c31332b9.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/scheduler.6402f0dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.29a31272.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.1b92e39a.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.70d92568.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.0cc09f3a.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.1d039802.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.a82faf3f.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/GithubMark.5170f17a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/store.be990f37.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/5.ade4c801.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/each.e59479a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Category.59a1a78b.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/MainSection.36a7ff61.js"><title>Typescript 5.5 주목할만한 변경점 : dlguswo333&#39;s blog</title><!-- HEAD_svelte-etxm8u_START --><!-- HEAD_svelte-etxm8u_END -->
		<!-- [TODO] For portability I can erase the following elements and inject them from index.ts when building? -->
		<title>dlguswo333's Blog</title>
		<meta name="google-site-verification" content="GIhlBkE7qu5AWLVmQ4w2lBcxEw-AumQhdQf_2zR2X4s" />
	</head>
	<body data-sveltekit-preload-data="hover">
		<script>
			const systemTheme= window.matchMedia('(prefers-color-scheme:dark)').matches ? 'dark' : 'light';
			const rootElement = document.querySelector('body');
			try {
				const storedValue = JSON.parse(localStorage.getItem('color-theme') || 'null');
				const currentTheme = storedValue === 'light' || storedValue === 'dark' ? storedValue : systemTheme;
				if(rootElement) {
  				rootElement.classList.add(currentTheme);
				}
			} catch {
				rootElement.classList.add(systemTheme);
			}
		</script>
		<div id="root">  <header class="z-10 p-2 sticky top-0 flex flex-row items-center justify-between border-b border-b-gray-300 bg-gray-50 dark:bg-[#2c3039] dark:border-b-gray-700"><div class="flex flex-row items-center gap-1"> <a href="/" class="inline-block h-8 w-8" data-svelte-h="svelte-htzscq"><span class="hidden">Go To Home</span> <img src="/favicon.svg" alt="Logo"></a> <button type="button" title="Toggle color theme" class="group"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="h-8 w-8 transition"><rect x="3" y="3" width="94" height="94" stroke-width="6" rx="16" ry="16" class="stroke-gray-600 fill-none"></rect></svg></button> </div> <div class="flex flex-row items-center"><a href="/categories/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Categories</a> <a href="/tags/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Tags</a> <a href="/about/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">About</a></div></header>  <div class="flex flex-row flex-grow justify-center p-2 lg:p-0 lg:pr-[300px]"> <aside class="w-[300px] overflow-hidden hidden mt-10 self-start md:!flex md:sticky md:top-14 flex-col justify-center items-center p-3
  "><div class="relative w-full"><ul class="max-h-[80vh] overflow-auto"> <li title="Inferred Type Predicate" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-bold 
        "><a href="#1-Inferred-Type-Predicate" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.3rem;">Inferred Type Predicate</a> </li> <li title="이점" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#2-이점" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">이점</a> </li> <li title="추론 조건" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#3-추론-조건" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">추론 조건</a> </li> <li title="Type Guard가 이제 Flow 됩니다" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#4-Type-Guard가-이제-Flow-됩니다" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Type Guard가 이제 Flow 됩니다</a> </li> <li title="Breaking Changes in Your Code" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#5-Breaking-Changes-in-Your-Code" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Breaking Changes in Your Code</a> </li> <li title="Control Flow Narrowing for Constant Indexed Accesses" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-bold 
        "><a href="#6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.3rem;">Control Flow Narrowing for Constant Indexed Accesses</a> </li></ul> </div></aside>  <div class="flex flex-col justify-center min-w-0 my-10 md:my-15"><div class="max-w-[900px] flex flex-col items-center py-6 gap-3"><h1 class="text-4xl font-bold text-center">Typescript 5.5 주목할만한 변경점</h1> <span>2024-05-18 </span> <button class="px-2 py-0.5 rounded-lg shadow-md shadow-emerald-50 border-l-slate-100 bg-sky-300 text-white hover:bg-sky-500 dark:shadow-emerald-900 transition">/Programming</button> <div><button class="last:mr-0 bg-green-100 hover:bg-green-400 hover:text-white dark:text-black transition px-2 py-0.5 rounded-xl shadow-md dark:shadow-green-900 my-0.5" style="margin-right: 0.25rem; margin-left: 0.5rem">#typescript</button></div> <div>🌐
            <a class="last:mr-0 my-0.5 transition px-2 py-0.5 rounded-md border-2
    bg-lime-100 dark:text-black dark:shadow-green-900
    border-yellow-300 shadow-inner cursor-default bg-lime-50" href="/post/2024/05-18-ko-typescript-5-5-notable-changes/" style="margin-right: 0.25rem; margin-left: 0.25rem">ko</a><a class="last:mr-0 my-0.5 transition px-2 py-0.5 rounded-md border-2
    bg-lime-100 dark:text-black dark:shadow-green-900
    shadow-md hover:text-white hover:bg-lime-400" href="/post/2024/05-18-en-typescript-5-5-notable-changes/" style="margin-right: 0.25rem; margin-left: 0.25rem">en</a></div></div> <hr class="bg-gray-400 my-4">  <main class="max-w-[900px] w-full py-2 post"> <!-- HTML_TAG_START --><p>Typescript 5.5 베타가 2024년 4월 25일 릴리즈 되었습니다!<br>
<a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta</a><br>
늘 그렇듯이 이번에도 변경점이 많은데요,
그러나 특히 눈에 띄는 타입 체크 관련 변경점이 있어 소개해드리도록 하겠습니다.</p>
<h1 id="1-Inferred-Type-Predicate">Inferred Type Predicate</h1>
<p>다음과 같은 <code>Bird</code>, <code>Fish</code> 두 타입이 있으며 둘이 Union 된 타입을 가진 변수가 있다고 칩시다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">type</span> <span class="token class-name">Bird</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token function-variable function">fly</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">type</span> <span class="token class-name">Fish</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    <span class="token function-variable function">swim</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token keyword">declare</span> <span class="token keyword">const</span> animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">;</span>
</span></code></pre>
<p>이 변수의 타입에 따라 다른 코드를 실행하는 브랜칭을 하고 싶습니다.
기존 타입스크립트의 타입 체크는 인라인으로 if 브랜치를 타거나:</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    animal<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>타입을 검사하는 함수, <em>User-defined Type Guard</em>를 정의하여
타입을 체크할 수 있었습니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token operator">:</span> animal <span class="token keyword">is</span> Bird <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>이렇게 <code>arg is Type</code> 불린을 반환하는 함수를 <em>Type Guard</em> 함수라고 부릅니다.</p>
<blockquote>
<p>To define a user-defined type guard, we simply need to define
a function whose return type is a type predicate:<br>
<a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates">https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates</a></p>
</blockquote>
<p>하지만 이렇게 별개의 함수를 만들 때 Type Predicate를 반환 타입으로
명시하지 않으면 타입스크립트는 해당 타입을 Narrowing 하지 않는 문제가 있습니다!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// Typescript does not see it as type guard function; it just returns a boolean!</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This line emits error!</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/no-type-predicate-function-error.png" alt="no-type-predicate-function-error"></p>
<p>로직 상으로는 문제가 전혀 없습니다. 타입 검사 후 <code>animal</code>이 <code>Bird</code> 타입임이 보장되며,
중간에 <code>animal</code> 변수가 변한 것도 아닙니다.
그저 타입스크립트가 이것을 처리할 수 없었던 것이죠.</p>
<p>하지만 이제 5.5 에서는 가능합니다!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span></code></pre>
<p>추론이 잘 되고 있는지는 LSP의 함수 Definition으로도 확인할 수 있습니다.
추론 되었다면 함수의 리턴 타입에 Type Predicate가 명시됩니다.</p>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/inferred-type-predicate.png" alt="inferred-type-predicate"></p>
<h2 id="2-이점">이점</h2>
<p>가장 명확한 장점은 이제 Type Predicate를 명시하지 않아도 된다는 점입니다.
하지만 더 나아가, 추론이 Arrow Function에도 동작하기 때문에,
지금껏 쓰지 못했던 <code>Array.filter(v => v !== null)</code>과 같은 코드에 대해서도
Type Narrowing이 동작합니다!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">declare</span> <span class="token keyword">const</span> animals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token operator">:</span> animal <span class="token keyword">is</span> Bird <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment">// We used to write this way.</span>
</span><span class="code-line line-number" line="8"><span class="token keyword">const</span> birds <span class="token operator">=</span> animals
</span><span class="code-line line-number" line="9">    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>getIsBird<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12"><span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="13"><span class="token keyword">const</span> birds <span class="token operator">=</span> animals
</span><span class="code-line line-number" line="14">  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15">  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>이제 꼭 별개의 Type Guard 함수를 선언하지 않아도 됩니다!</p>
<h2 id="3-추론-조건">추론 조건</h2>
<p>타입스크립트 5.5부터 Type Predicate가 명시되지 않은 함수에 대해서도
아래 조건을 충족하면 Type Predicate를 반환하는 함수임을 <em>추론</em> 합니다.
대개의 경우 평소 쓰던 것처럼 Type Guard 함수를 작성하면 잘 동작할 겁니다.</p>
<ol>
<li>명시된 리턴 타입이나 Type Predicate가 없어야 함.</li>
<li><code>return</code> 문이 하나만 있어야 하며 implicit return은 없어야 함.</li>
<li>인자를 변형하지 않아야 함.</li>
<li>파라미터와 연관하여 <code>boolean</code> 표현식 (expression)을 리턴해야 함.</li>
</ol>
<p>1번 조건과 관련하여, <code>boolean</code>을 명시해주어도 안됩니다.
그리고 Type Predicate를 명시하면 추론의 필요가 없겠죠.</p>
<p>2번은 함수가 명시적인 리턴을 해야 추론이 가능함을 나타냅니다.
또한 리턴 문이 하나만 존재해야 함에 주의하세요.
다음은 추론이 안되는 코드 예시입니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// No Inferred Type Predicate</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
</span><span class="code-line line-number" line="3">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token comment">// No Inferred Type Predicate</span>
</span><span class="code-line line-number" line="10"><span class="token keyword">function</span> <span class="token function">getIsBirdNotFishOrDog</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish <span class="token operator">|</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'bark'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="12">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="14">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="15">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="16">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="17">  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span></code></pre>
<p>4번은 실제로 인자의 타입을 검사해야 <code>true</code>가 나올 code path와
<code>false</code>가 나올 code path를 타입스크립트가 검사해
추론할 수 있음을 의미합니다.
예를 들어 아래는 안됩니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>희한하게 아래 코드도 안됩니다. 리턴 값이 <code>true</code>라면
<code>animal</code>이 <code>Bird</code>임이 보장이 됨에도요.
이것은 왜인지 잘 모르겠네요.<br>
PR을 읽어보면 Type Guard는 <em>if and only if</em> 가 되어야만 합니다.
그래서 <code>return 'fly' in animal &#x26;&#x26; Math.random() > 0.5</code>는
<code>Bird</code> 인자가 전달되어도 뒤 표현식에 따라
리턴 값이 달라질 수 있으므로 타입 가드 함수라고 할 수 없는 것이죠.
그럼에도 불구하고 <code>&#x26;&#x26; true</code>는 왜 타입 가드가 아닌지 설명이 안되는군요.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal <span class="token operator">&#x26;&#x26;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>이외에도 Inferred Type Predicate는 제가 소개드리지 못한 상세 사항이 많으니
더 자세한 사항은 공식 문서와 PR을 참조해 주세요.</p>
<p><a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates</a>
<a href="https://github.com/microsoft/TypeScript/pull/57465">https://github.com/microsoft/TypeScript/pull/57465</a></p>
<h2 id="4-Type-Guard가-이제-Flow-됩니다">Type Guard가 이제 Flow 됩니다</h2>
<p>이제 타입스크립트의 Type Guard도 Flow 됩니다!
그 말인즉슨, Type Guard 함수를 감싸 그대로 반환하면 Type Predicate가 Deprecated 되었는데
이제 위에서 말한 바와 같이 Type Predicate가 추론 되니 Type Predicate가 보존됩니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token comment">// This function returns type predicate since 5.5!</span>
</span><span class="code-line line-number" line="6"><span class="token keyword">function</span> <span class="token function">wrappedGetIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">  <span class="token keyword">return</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="5-Breaking-Changes-in-Your-Code">Breaking Changes in Your Code</h2>
<p>이제 일반 함수에 대해서 조건이 일치한다면
<code>boolean</code>이 아닌 Type Predicate를 반환하게 되므로
그에 따라 타입이 의도치 않게 변경되어 기존 코드에서
타입 에러가 발생할 수 있습니다.</p>
<p>Type Narrowing이 필요하지 않음에도 불구하고
Inferred Type Predicate로 인해 타입이 검사되어
필터 아웃된 타입을 변수에 사용하려 할 때
에러가 발생할 가능성이 있습니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">declare</span> <span class="token keyword">const</span> animals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function">removeBirds</span> <span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> <span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment">// We only wanted to filter out Birds, but the returned value</span>
</span><span class="code-line line-number" line="8"><span class="token comment">// now reject Bird!</span>
</span><span class="code-line line-number" line="9"><span class="token keyword">const</span> filteredAnimals <span class="token operator">=</span> <span class="token function">removeBirds</span><span class="token punctuation">(</span>animals<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">filteredAnimals<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newBird<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error since 5.5!</span>
</span></code></pre>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/unwanted-inferred-type-predicate.png" alt="unwanted-inferred-type-predicate"></p>
<p>이와 같은 경우에는 Explicit Type으로 해결할 수 있습니다.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> filteredAnimals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">removeBirds</span><span class="token punctuation">(</span>animals<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h1 id="6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses">Control Flow Narrowing for Constant Indexed Accesses</h1>
<p>이제 Object와 key가 constant 하다면 Type Narrowing 할 수 있습니다!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getDouble</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> Record<span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">        <span class="token keyword">const</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">        <span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="5">        <span class="token keyword">return</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="7">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<p>코드에서 <code>obj</code> <code>key</code> 둘 다 불변하기에 if 문 내부에서 <code>obj[key]</code>가
<code>number</code> 타입임이 보장되나 타입스크립트는 이를 파악하지 못했습니다.
하지만 이제 5.5 부터는 가능합니다!</p><!-- HTML_TAG_END --></main></div></div> <footer class="p-2 py-5 text-sm flex gap-1 flex-col md:flex-row items-center justify-between border-t border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-[#2c3039]"><div>© 2021~2024 dlguswo333; All rights reserved.</div> <div class="flex items-center"><a class="inline-flex items-center" href="https://github.com/dlguswo333/dlguswo333.github.io"><img class="inline h-4 w-4 mr-1" src="/github-mark.svg" alt="github-mark"></a>
    Built with Sveltekit.</div></footer>  
			
			<script>
				{
					__sveltekit_dggk4z = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{html:"\u003Cp>Typescript 5.5 베타가 2024년 4월 25일 릴리즈 되었습니다!\u003Cbr>\n\u003Ca href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta\">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta\u003C/a>\u003Cbr>\n늘 그렇듯이 이번에도 변경점이 많은데요,\n그러나 특히 눈에 띄는 타입 체크 관련 변경점이 있어 소개해드리도록 하겠습니다.\u003C/p>\n\u003Ch1 id=\"1-Inferred-Type-Predicate\">Inferred Type Predicate\u003C/h1>\n\u003Cp>다음과 같은 \u003Ccode>Bird\u003C/code>, \u003Ccode>Fish\u003C/code> 두 타입이 있으며 둘이 Union 된 타입을 가진 변수가 있다고 칩시다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">type\u003C/span> \u003Cspan class=\"token class-name\">Bird\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token function-variable function\">fly\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token keyword\">void\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token keyword\">type\u003C/span> \u003Cspan class=\"token class-name\">Fish\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token function-variable function\">swim\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token keyword\">void\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>이 변수의 타입에 따라 다른 코드를 실행하는 브랜칭을 하고 싶습니다.\n기존 타입스크립트의 타입 체크는 인라인으로 if 브랜치를 타거나:\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">swim\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>타입을 검사하는 함수, \u003Cem>User-defined Type Guard\u003C/em>를 정의하여\n타입을 체크할 수 있었습니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> animal \u003Cspan class=\"token keyword\">is\u003C/span> Bird \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>이렇게 \u003Ccode>arg is Type\u003C/code> 불린을 반환하는 함수를 \u003Cem>Type Guard\u003C/em> 함수라고 부릅니다.\u003C/p>\n\u003Cblockquote>\n\u003Cp>To define a user-defined type guard, we simply need to define\na function whose return type is a type predicate:\u003Cbr>\n\u003Ca href=\"https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates\">https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cp>하지만 이렇게 별개의 함수를 만들 때 Type Predicate를 반환 타입으로\n명시하지 않으면 타입스크립트는 해당 타입을 Narrowing 하지 않는 문제가 있습니다!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token comment\">// Typescript does not see it as type guard function; it just returns a boolean!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// This line emits error!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/no-type-predicate-function-error.png\" alt=\"no-type-predicate-function-error\">\u003C/p>\n\u003Cp>로직 상으로는 문제가 전혀 없습니다. 타입 검사 후 \u003Ccode>animal\u003C/code>이 \u003Ccode>Bird\u003C/code> 타입임이 보장되며,\n중간에 \u003Ccode>animal\u003C/code> 변수가 변한 것도 아닙니다.\n그저 타입스크립트가 이것을 처리할 수 없었던 것이죠.\u003C/p>\n\u003Cp>하지만 이제 5.5 에서는 가능합니다!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>추론이 잘 되고 있는지는 LSP의 함수 Definition으로도 확인할 수 있습니다.\n추론 되었다면 함수의 리턴 타입에 Type Predicate가 명시됩니다.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/inferred-type-predicate.png\" alt=\"inferred-type-predicate\">\u003C/p>\n\u003Ch2 id=\"2-이점\">이점\u003C/h2>\n\u003Cp>가장 명확한 장점은 이제 Type Predicate를 명시하지 않아도 된다는 점입니다.\n하지만 더 나아가, 추론이 Arrow Function에도 동작하기 때문에,\n지금껏 쓰지 못했던 \u003Ccode>Array.filter(v => v !== null)\u003C/code>과 같은 코드에 대해서도\nType Narrowing이 동작합니다!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> animal \u003Cspan class=\"token keyword\">is\u003C/span> Bird \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token comment\">// We used to write this way.\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token keyword\">const\u003C/span> birds \u003Cspan class=\"token operator\">=\u003C/span> animals\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>getIsBird\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">forEach\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token keyword\">const\u003C/span> birds \u003Cspan class=\"token operator\">=\u003C/span> animals\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">  \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">forEach\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>이제 꼭 별개의 Type Guard 함수를 선언하지 않아도 됩니다!\u003C/p>\n\u003Ch2 id=\"3-추론-조건\">추론 조건\u003C/h2>\n\u003Cp>타입스크립트 5.5부터 Type Predicate가 명시되지 않은 함수에 대해서도\n아래 조건을 충족하면 Type Predicate를 반환하는 함수임을 \u003Cem>추론\u003C/em> 합니다.\n대개의 경우 평소 쓰던 것처럼 Type Guard 함수를 작성하면 잘 동작할 겁니다.\u003C/p>\n\u003Col>\n\u003Cli>명시된 리턴 타입이나 Type Predicate가 없어야 함.\u003C/li>\n\u003Cli>\u003Ccode>return\u003C/code> 문이 하나만 있어야 하며 implicit return은 없어야 함.\u003C/li>\n\u003Cli>인자를 변형하지 않아야 함.\u003C/li>\n\u003Cli>파라미터와 연관하여 \u003Ccode>boolean\u003C/code> 표현식 (expression)을 리턴해야 함.\u003C/li>\n\u003C/ol>\n\u003Cp>1번 조건과 관련하여, \u003Ccode>boolean\u003C/code>을 명시해주어도 안됩니다.\n그리고 Type Predicate를 명시하면 추론의 필요가 없겠죠.\u003C/p>\n\u003Cp>2번은 함수가 명시적인 리턴을 해야 추론이 가능함을 나타냅니다.\n또한 리턴 문이 하나만 존재해야 함에 주의하세요.\n다음은 추론이 안되는 코드 예시입니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token comment\">// No Inferred Type Predicate\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span> \n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token comment\">// No Inferred Type Predicate\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBirdNotFishOrDog\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish \u003Cspan class=\"token operator\">|\u003C/span> Dog\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'bark'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>4번은 실제로 인자의 타입을 검사해야 \u003Ccode>true\u003C/code>가 나올 code path와\n\u003Ccode>false\u003C/code>가 나올 code path를 타입스크립트가 검사해\n추론할 수 있음을 의미합니다.\n예를 들어 아래는 안됩니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>희한하게 아래 코드도 안됩니다. 리턴 값이 \u003Ccode>true\u003C/code>라면\n\u003Ccode>animal\u003C/code>이 \u003Ccode>Bird\u003C/code>임이 보장이 됨에도요.\n이것은 왜인지 잘 모르겠네요.\u003Cbr>\nPR을 읽어보면 Type Guard는 \u003Cem>if and only if\u003C/em> 가 되어야만 합니다.\n그래서 \u003Ccode>return 'fly' in animal &#x26;&#x26; Math.random() > 0.5\u003C/code>는\n\u003Ccode>Bird\u003C/code> 인자가 전달되어도 뒤 표현식에 따라\n리턴 값이 달라질 수 있으므로 타입 가드 함수라고 할 수 없는 것이죠.\n그럼에도 불구하고 \u003Ccode>&#x26;&#x26; true\u003C/code>는 왜 타입 가드가 아닌지 설명이 안되는군요.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>이외에도 Inferred Type Predicate는 제가 소개드리지 못한 상세 사항이 많으니\n더 자세한 사항은 공식 문서와 PR을 참조해 주세요.\u003C/p>\n\u003Cp>\u003Ca href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates\">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates\u003C/a>\n\u003Ca href=\"https://github.com/microsoft/TypeScript/pull/57465\">https://github.com/microsoft/TypeScript/pull/57465\u003C/a>\u003C/p>\n\u003Ch2 id=\"4-Type-Guard가-이제-Flow-됩니다\">Type Guard가 이제 Flow 됩니다\u003C/h2>\n\u003Cp>이제 타입스크립트의 Type Guard도 Flow 됩니다!\n그 말인즉슨, Type Guard 함수를 감싸 그대로 반환하면 Type Predicate가 Deprecated 되었는데\n이제 위에서 말한 바와 같이 Type Predicate가 추론 되니 Type Predicate가 보존됩니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token comment\">// This function returns type predicate since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">wrappedGetIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"5-Breaking-Changes-in-Your-Code\">Breaking Changes in Your Code\u003C/h2>\n\u003Cp>이제 일반 함수에 대해서 조건이 일치한다면\n\u003Ccode>boolean\u003C/code>이 아닌 Type Predicate를 반환하게 되므로\n그에 따라 타입이 의도치 않게 변경되어 기존 코드에서\n타입 에러가 발생할 수 있습니다.\u003C/p>\n\u003Cp>Type Narrowing이 필요하지 않음에도 불구하고\nInferred Type Predicate로 인해 타입이 검사되어\n필터 아웃된 타입을 변수에 사용하려 할 때\n에러가 발생할 가능성이 있습니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>arr\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">return\u003C/span> arr\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token comment\">// We only wanted to filter out Birds, but the returned value\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token comment\">// now reject Bird!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token keyword\">const\u003C/span> filteredAnimals \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animals\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">filteredAnimals\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">push\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>newBird\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// Error since 5.5!\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/unwanted-inferred-type-predicate.png\" alt=\"unwanted-inferred-type-predicate\">\u003C/p>\n\u003Cp>이와 같은 경우에는 Explicit Type으로 해결할 수 있습니다.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">const\u003C/span> filteredAnimals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animals\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses\">Control Flow Narrowing for Constant Indexed Accesses\u003C/h1>\n\u003Cp>이제 Object와 key가 constant 하다면 Type Narrowing 할 수 있습니다!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getDouble\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>obj\u003Cspan class=\"token operator\">:\u003C/span> Record\u003Cspan class=\"token operator\">&#x3C;\u003C/span>\u003Cspan class=\"token builtin\">string\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> \u003Cspan class=\"token builtin\">number\u003C/span> \u003Cspan class=\"token operator\">|\u003C/span> \u003Cspan class=\"token keyword\">null\u003C/span>\u003Cspan class=\"token operator\">>\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> key\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token builtin\">string\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token builtin\">number\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>obj\u003Cspan class=\"token punctuation\">[\u003C/span>key\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">        \u003Cspan class=\"token keyword\">const\u003C/span> value \u003Cspan class=\"token operator\">=\u003C/span> obj\u003Cspan class=\"token punctuation\">[\u003C/span>key\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">        \u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">        \u003Cspan class=\"token keyword\">return\u003C/span> value \u003Cspan class=\"token operator\">*\u003C/span> \u003Cspan class=\"token number\">2\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token number\">0\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>코드에서 \u003Ccode>obj\u003C/code> \u003Ccode>key\u003C/code> 둘 다 불변하기에 if 문 내부에서 \u003Ccode>obj[key]\u003C/code>가\n\u003Ccode>number\u003C/code> 타입임이 보장되나 타입스크립트는 이를 파악하지 못했습니다.\n하지만 이제 5.5 부터는 가능합니다!\u003C/p>",frontmatter:{layout:"post",toc:true,title:"Typescript 5.5 주목할만한 변경점",category:["Programming"],tags:["typescript"],author:["이현재"]},date:"2024-05-18",lang:"ko",id:"05-18-ko-typescript-5-5-notable-changes",tocData:[{depth:1,id:"1-Inferred-Type-Predicate",text:"Inferred Type Predicate"},{depth:2,id:"2-이점",text:"이점"},{depth:2,id:"3-추론-조건",text:"추론 조건"},{depth:2,id:"4-Type-Guard가-이제-Flow-됩니다",text:"Type Guard가 이제 Flow 됩니다"},{depth:2,id:"5-Breaking-Changes-in-Your-Code",text:"Breaking Changes in Your Code"},{depth:1,id:"6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses",text:"Control Flow Narrowing for Constant Indexed Accesses"}],langs:["ko","en"]},"uses":{"params":["year","slug"]}}];

					Promise.all([
						import("../../../_app/immutable/entry/start.c31332b9.js"),
						import("../../../_app/immutable/entry/app.70d92568.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
