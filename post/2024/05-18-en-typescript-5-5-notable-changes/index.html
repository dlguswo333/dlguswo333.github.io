<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" href="../../../favicon.ico" />
		<meta name="viewport" content="width=device-width" />
		
		<link href="../../../_app/immutable/assets/0.fcd7d0f0.css" rel="stylesheet">
		<link rel="modulepreload" href="../../../_app/immutable/entry/start.7b02dd09.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/scheduler.6402f0dd.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/singletons.15171e31.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.1b92e39a.js">
		<link rel="modulepreload" href="../../../_app/immutable/entry/app.beba005d.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.0cc09f3a.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/0.4aa59b97.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/index.a82faf3f.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/GithubMark.5170f17a.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/store.be990f37.js">
		<link rel="modulepreload" href="../../../_app/immutable/nodes/5.e38b54f4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/each.e59479a4.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/Category.a9d34eee.js">
		<link rel="modulepreload" href="../../../_app/immutable/chunks/MainSection.4262151e.js"><title>Typescript 5.5 Noticeable Changes : dlguswo333&#39;s blog</title><!-- HEAD_svelte-etxm8u_START --><!-- HEAD_svelte-etxm8u_END -->
		<!-- [TODO] For portability I can erase the following elements and inject them from index.ts when building? -->
		<title>dlguswo333's Blog</title>
		<meta name="google-site-verification" content="GIhlBkE7qu5AWLVmQ4w2lBcxEw-AumQhdQf_2zR2X4s" />
	</head>
	<body data-sveltekit-preload-data="hover">
		<script>
			const systemTheme= window.matchMedia('(prefers-color-scheme:dark)').matches ? 'dark' : 'light';
			const rootElement = document.querySelector('body');
			try {
				const storedValue = JSON.parse(localStorage.getItem('color-theme') || 'null');
				const currentTheme = storedValue === 'light' || storedValue === 'dark' ? storedValue : systemTheme;
				if(rootElement) {
  				rootElement.classList.add(currentTheme);
				}
			} catch {
				rootElement.classList.add(systemTheme);
			}
		</script>
		<div id="root">  <header class="z-10 p-2 sticky top-0 flex flex-row items-center justify-between border-b border-b-gray-300 bg-gray-50 dark:bg-[#2c3039] dark:border-b-gray-700"><div class="flex flex-row items-center gap-1"> <a href="/" class="inline-block h-8 w-8" data-svelte-h="svelte-htzscq"><span class="hidden">Go To Home</span> <img src="/favicon.svg" alt="Logo"></a> <button type="button" title="Toggle color theme" class="group"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="h-8 w-8 transition"><rect x="3" y="3" width="94" height="94" stroke-width="6" rx="16" ry="16" class="stroke-gray-600 fill-none"></rect></svg></button> </div> <div class="flex flex-row items-center"><a href="/categories/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Categories</a> <a href="/tags/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">Tags</a> <a href="/about/" class="h-8 flex items-center justify-center mr-2 last:mr-1 px-1 py-0.5 rounded hover:bg-gray-200 dark:hover:bg-slate-600 dark:hover:text-white">About</a></div></header>  <div class="flex flex-row flex-grow justify-center p-2 lg:p-0 lg:pr-[300px]"> <aside class="w-[300px] overflow-hidden hidden mt-10 self-start md:!flex md:sticky md:top-14 flex-col justify-center items-center p-3
  "><div class="relative w-full"><ul class="max-h-[80vh] overflow-auto"> <li title="Inferred Type Predicate" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-bold 
        "><a href="#1-Inferred-Type-Predicate" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.3rem;">Inferred Type Predicate</a> </li> <li title="Advantages" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#2-Advantages" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Advantages</a> </li> <li title="Inference Condition" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#3-Inference-Condition" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Inference Condition</a> </li> <li title="Type Guard Now Flows" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#4-Type-Guard-Now-Flows" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Type Guard Now Flows</a> </li> <li title="Breaking Changes in Your Code" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700  
        "><a href="#5-Breaking-Changes-in-Your-Code" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.9666666666666666rem;">Breaking Changes in Your Code</a> </li> <li title="Control Flow Narrowing for Constant Indexed Accesses" class="flex border-l-4 border-transparent hover:border-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-bold 
        "><a href="#6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses" class="relative z-10 py-0.5 whitespace-nowrap overflow-hidden break-all overflow-ellipsis flex-grow" style="padding-left: 0.3rem;">Control Flow Narrowing for Constant Indexed Accesses</a> </li></ul> </div></aside>  <div class="flex flex-col justify-center min-w-0 my-10 md:my-15"><div class="max-w-[900px] flex flex-col items-center py-6 gap-3"><h1 class="text-4xl font-bold text-center">Typescript 5.5 Noticeable Changes</h1> <span>2024-05-18 </span> <button class="px-2 py-0.5 rounded-lg shadow-md shadow-emerald-50 border-l-slate-100 bg-sky-300 text-white hover:bg-sky-500 dark:shadow-emerald-900 transition">/Programming</button> <div><button class="last:mr-0 bg-green-100 hover:bg-green-400 hover:text-white dark:text-black transition px-2 py-0.5 rounded-xl shadow-md dark:shadow-green-900 my-0.5" style="margin-right: 0.25rem; margin-left: 0.5rem">#typescript</button></div> <div>üåê
            <a class="last:mr-0 my-0.5 transition px-2 py-0.5 rounded-md border-2
    bg-lime-100 dark:text-black dark:shadow-green-900
    shadow-md hover:text-white hover:bg-lime-400" href="/post/2024/05-18-ko-typescript-5-5-notable-changes/" style="margin-right: 0.25rem; margin-left: 0.25rem">ko</a><a class="last:mr-0 my-0.5 transition px-2 py-0.5 rounded-md border-2
    bg-lime-100 dark:text-black dark:shadow-green-900
    border-yellow-300 shadow-inner cursor-default bg-lime-50" href="/post/2024/05-18-en-typescript-5-5-notable-changes/" style="margin-right: 0.25rem; margin-left: 0.25rem">en</a></div></div> <hr class="bg-gray-400 my-4">  <main class="max-w-[900px] w-full py-2 post"> <!-- HTML_TAG_START --><p>Typescript 5.5 beta has been released on April 25th, 2024!<br>
<a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta</a><br>
As always has been, this new update brings lots of changes,
But there are some exceptional changes related to type checking
so let me introduce those things.</p>
<h1 id="1-Inferred-Type-Predicate">Inferred Type Predicate</h1>
<p>Let us say there are two types <code>Bird</code>, <code>Fish</code> and a variable with type of union of the two.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">type</span> <span class="token class-name">Bird</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token function-variable function">fly</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">type</span> <span class="token class-name">Fish</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    <span class="token function-variable function">swim</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token keyword">declare</span> <span class="token keyword">const</span> animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">;</span>
</span></code></pre>
<p>You want to execute different lines of code according to the type of the variable.
In previous Typescript you would either have if statement:</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    animal<span class="token punctuation">.</span><span class="token function">swim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>Else define a type checking funtion: <em>User-defined Type Guard</em>
to check the type.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token operator">:</span> animal <span class="token keyword">is</span> Bird <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>Such functions that returns a <code>arg is Type</code> boolean are called <em>Type Guard</em> functions.</p>
<blockquote>
<p>To define a user-defined type guard, we simply need to define
a function whose return type is a type predicate:<br>
<a href="https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates">https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates</a></p>
</blockquote>
<p>However when you define such separate functions you need to define Type Predicate
as the return type else Typescript would not narrow the target parameter type!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// Typescript does not see it as type guard function; it just returns a boolean!</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="5">
</span><span class="code-line line-number" line="6"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">    animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This line emits error!</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/no-type-predicate-function-error.png" alt="no-type-predicate-function-error"></p>
<p>There is no issue in the logics. After checking the type <code>animal</code> is guranteed to be <code>Bird</code> type
and <code>animal</code> variable has not been changed.
It was just because Typescript could not handle it.</p>
<p>But from 5.5 Typescript can handle this!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="6">    animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span></code></pre>
<p>You can see from type definition of function with LSP it implicitly check the type.
since it can infer the type Type Predciate is denoted as return type.</p>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/inferred-type-predicate.png" alt="inferred-type-predicate"></p>
<h2 id="2-Advantages">Advantages</h2>
<p>The most prominent Advantage is that you do not need to denote Type Predicate.<br>
But From that onwards, because inference also works on arrow functions,
Type narrowing are added to the codes that had not been
such as <code>Array.filter(v => v !== null)</code>!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">declare</span> <span class="token keyword">const</span> animals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token operator">:</span> animal <span class="token keyword">is</span> Bird <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment">// We used to write this way.</span>
</span><span class="code-line line-number" line="8"><span class="token keyword">const</span> birds <span class="token operator">=</span> animals
</span><span class="code-line line-number" line="9">    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>getIsBird<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="10">    <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="11">
</span><span class="code-line line-number" line="12"><span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="13"><span class="token keyword">const</span> birds <span class="token operator">=</span> animals
</span><span class="code-line line-number" line="14">  <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span>
</span><span class="code-line line-number" line="15">  <span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> animal<span class="token punctuation">.</span><span class="token function">fly</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<p>You don't need to define Type Guard function separately!</p>
<h2 id="3-Inference-Condition">Inference Condition</h2>
<p>From Typescript 5.5 even functions without Type Predicate
will be <em>inferred</em> to return Type Predicate if they hold the following conditions.
Most of the times they will be inferred well
if you wrote them in the way you would normally write Type Guard function.</p>
<ol>
<li>There should be no denoted return types or Type Predicate.</li>
<li>There should be only one <code>return</code> statement and no implicit returns.</li>
<li>It should not modify the parameter.</li>
<li>It should return <code>boolean</code> expression with respect to the parameter.</li>
</ol>
<p>As with the first condition, you shouldn't even denote <code>boolean</code> return type.
And there is no meaning of inference if it explicitly returns Type Predicate.</p>
<p>The second one tells that the inference needs the function to return explicitly.
Also keep in mind the return statement should not be more than one.
The next codes are examples of no inference.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token comment">// No Inferred Type Predicate</span>
</span><span class="code-line line-number" line="2"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
</span><span class="code-line line-number" line="3">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="7"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="8">
</span><span class="code-line line-number" line="9"><span class="token comment">// No Inferred Type Predicate</span>
</span><span class="code-line line-number" line="10"><span class="token keyword">function</span> <span class="token function">getIsBirdNotFishOrDog</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish <span class="token operator">|</span> Dog<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="11">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'bark'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="12">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="13">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="14">  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="15">    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="16">  <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="17">  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="18"><span class="token punctuation">}</span>
</span></code></pre>
<p>The fourth means that you need to actually inspect the type of parameter
so that Typescript check the code path which would return <code>true</code> or <code>false</code>
to infer Type Predicate.
For example the below would not work as it does not tell Typescript anything.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<p>Oddly the following code does not work either.
If the returned value is <code>true</code> it does mean that <code>animal</code> is of <code>Bird</code> type.<br>
If you read the pull request of Inferred Type Predicate,
Type Guard must be <em>if and only if</em>.
Thus <code>return 'fly' in animal &#x26;&#x26; Math.random() > 0.5</code> code
may return different boolean values according to the right hand side operand
even though it is handed a <code>Bird</code> parameter;
as a result it is not a Type Guard function.
Nevertheless it does not quite explain why <code>&#x26;&#x26; true</code> is not a Type Guard expression.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal <span class="token operator">&#x26;&#x26;</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span></code></pre>
<br>
<p>There are more details that I could not introduce about Inferred Type Predicate,
so for more please visite the official documentation and PR.</p>
<p><a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates</a>
<a href="https://github.com/microsoft/TypeScript/pull/57465">https://github.com/microsoft/TypeScript/pull/57465</a></p>
<h2 id="4-Type-Guard-Now-Flows">Type Guard Now Flows</h2>
<p>Now Type Guard in TypeScript now Flows!
That means, if you wrap a Type Guard function and return it as is
Type Predicate would be deprecated.
But as told earlier, since Type Predicate is now inferred, Type Predicate is also preserved.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">  <span class="token keyword">return</span> <span class="token string">'fly'</span> <span class="token keyword">in</span> animal<span class="token punctuation">;</span>
</span><span class="code-line line-number" line="3"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="4">
</span><span class="code-line line-number" line="5"><span class="token comment">// This function returns type predicate since 5.5!</span>
</span><span class="code-line line-number" line="6"><span class="token keyword">function</span> <span class="token function">wrappedGetIsBird</span> <span class="token punctuation">(</span>animal<span class="token operator">:</span> Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="7">  <span class="token keyword">return</span> <span class="token function">getIsBird</span><span class="token punctuation">(</span>animal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<h2 id="5-Breaking-Changes-in-Your-Code">Breaking Changes in Your Code</h2>
<p>From 5.5 as long as for normal functions if they hold the inference conditions
they will return Type Predicate not <code>boolean</code>.
It means variable types could have changed unintentionally
and leads to unwanted type errors.</p>
<p>Even though type narrowing is not needed,
since Inferred Type Predicates check the types.
If you try to assign a value of type which is filtered out
it may throws an error.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">declare</span> <span class="token keyword">const</span> animals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="2">
</span><span class="code-line line-number" line="3"><span class="token keyword">function</span> <span class="token function">removeBirds</span> <span class="token punctuation">(</span>arr<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="4">  <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>animal <span class="token operator">=></span> <span class="token string">'swim'</span> <span class="token keyword">in</span> animal<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="5"><span class="token punctuation">}</span>
</span><span class="code-line line-number" line="6">
</span><span class="code-line line-number" line="7"><span class="token comment">// We only wanted to filter out Birds, but the returned value</span>
</span><span class="code-line line-number" line="8"><span class="token comment">// now reject Bird!</span>
</span><span class="code-line line-number" line="9"><span class="token keyword">const</span> filteredAnimals <span class="token operator">=</span> <span class="token function">removeBirds</span><span class="token punctuation">(</span>animals<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="10">filteredAnimals<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>newBird<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Error since 5.5!</span>
</span></code></pre>
<p><img src="/img/2024-05-18-ko-typescript-5-5-notable-changes/unwanted-inferred-type-predicate.png" alt="unwanted-inferred-type-predicate"></p>
<p>Cases like this can be handled with explicit typings.</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">const</span> filteredAnimals<span class="token operator">:</span> <span class="token punctuation">(</span>Bird <span class="token operator">|</span> Fish<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">removeBirds</span><span class="token punctuation">(</span>animals<span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h1 id="6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses">Control Flow Narrowing for Constant Indexed Accesses</h1>
<p>Now as long as an object and a key are constant it can be type-narrowed!</p>
<pre class="language-ts"><code class="language-ts code-highlight"><span class="code-line line-number" line="1"><span class="token keyword">function</span> <span class="token function">getDouble</span><span class="token punctuation">(</span>obj<span class="token operator">:</span> Record<span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span> <span class="token operator">|</span> <span class="token keyword">null</span><span class="token operator">></span><span class="token punctuation">,</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="2">    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
</span><span class="code-line line-number" line="3">        <span class="token keyword">const</span> value <span class="token operator">=</span> obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="4">        <span class="token comment">// This is fine since 5.5!</span>
</span><span class="code-line line-number" line="5">        <span class="token keyword">return</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="6">    <span class="token punctuation">}</span>
</span><span class="code-line line-number" line="7">    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
</span><span class="code-line line-number" line="8"><span class="token punctuation">}</span>
</span></code></pre>
<p>In the code above as both <code>obj</code> and <code>key</code> are constant,
inside the if block <code>obj[key]</code> is gurantedd to be of <code>number</code> type
but Typescript did not notice it.
But since 5.5 it can!</p><!-- HTML_TAG_END --></main></div></div> <footer class="p-2 py-5 text-sm flex gap-1 flex-col md:flex-row items-center justify-between border-t border-gray-300 bg-gray-50 dark:border-gray-700 dark:bg-[#2c3039]"><div>¬© 2021~2024 dlguswo333; All rights reserved.</div> <div class="flex items-center"><a class="inline-flex items-center" href="https://github.com/dlguswo333/dlguswo333.github.io"><img class="inline h-4 w-4 mr-1" src="/github-mark.svg" alt="github-mark"></a>
    Built with Sveltekit.</div></footer>  
			
			<script>
				{
					__sveltekit_8m5s7y = {
						base: new URL("../../..", location).pathname.slice(0, -1),
						env: {}
					};

					const element = document.currentScript.parentElement;

					const data = [null,{"type":"data","data":{html:"\u003Cp>Typescript 5.5 beta has been released on April 25th, 2024!\u003Cbr>\n\u003Ca href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta\">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta\u003C/a>\u003Cbr>\nAs always has been, this new update brings lots of changes,\nBut there are some exceptional changes related to type checking\nso let me introduce those things.\u003C/p>\n\u003Ch1 id=\"1-Inferred-Type-Predicate\">Inferred Type Predicate\u003C/h1>\n\u003Cp>Let us say there are two types \u003Ccode>Bird\u003C/code>, \u003Ccode>Fish\u003C/code> and a variable with type of union of the two.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">type\u003C/span> \u003Cspan class=\"token class-name\">Bird\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token function-variable function\">fly\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token keyword\">void\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token keyword\">type\u003C/span> \u003Cspan class=\"token class-name\">Fish\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token function-variable function\">swim\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token keyword\">void\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>You want to execute different lines of code according to the type of the variable.\nIn previous Typescript you would either have if statement:\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">swim\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Else define a type checking funtion: \u003Cem>User-defined Type Guard\u003C/em>\nto check the type.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> animal \u003Cspan class=\"token keyword\">is\u003C/span> Bird \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Such functions that returns a \u003Ccode>arg is Type\u003C/code> boolean are called \u003Cem>Type Guard\u003C/em> functions.\u003C/p>\n\u003Cblockquote>\n\u003Cp>To define a user-defined type guard, we simply need to define\na function whose return type is a type predicate:\u003Cbr>\n\u003Ca href=\"https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates\">https://www.typescriptlang.org/docs/handbook/2/narrowing.html#using-type-predicates\u003C/a>\u003C/p>\n\u003C/blockquote>\n\u003Cp>However when you define such separate functions you need to define Type Predicate\nas the return type else Typescript would not narrow the target parameter type!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token comment\">// Typescript does not see it as type guard function; it just returns a boolean!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// This line emits error!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/no-type-predicate-function-error.png\" alt=\"no-type-predicate-function-error\">\u003C/p>\n\u003Cp>There is no issue in the logics. After checking the type \u003Ccode>animal\u003C/code> is guranteed to be \u003Ccode>Bird\u003C/code> type\nand \u003Ccode>animal\u003C/code> variable has not been changed.\nIt was just because Typescript could not handle it.\u003C/p>\n\u003Cp>But from 5.5 Typescript can handle this!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>You can see from type definition of function with LSP it implicitly check the type.\nsince it can infer the type Type Predciate is denoted as return type.\u003C/p>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/inferred-type-predicate.png\" alt=\"inferred-type-predicate\">\u003C/p>\n\u003Ch2 id=\"2-Advantages\">Advantages\u003C/h2>\n\u003Cp>The most prominent Advantage is that you do not need to denote Type Predicate.\u003Cbr>\nBut From that onwards, because inference also works on arrow functions,\nType narrowing are added to the codes that had not been\nsuch as \u003Ccode>Array.filter(v => v !== null)\u003C/code>!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> animal \u003Cspan class=\"token keyword\">is\u003C/span> Bird \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token comment\">// We used to write this way.\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token keyword\">const\u003C/span> birds \u003Cspan class=\"token operator\">=\u003C/span> animals\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">    \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>getIsBird\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">    \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">forEach\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">\u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">\u003Cspan class=\"token keyword\">const\u003C/span> birds \u003Cspan class=\"token operator\">=\u003C/span> animals\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">  \u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">forEach\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> animal\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">fly\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>You don't need to define Type Guard function separately!\u003C/p>\n\u003Ch2 id=\"3-Inference-Condition\">Inference Condition\u003C/h2>\n\u003Cp>From Typescript 5.5 even functions without Type Predicate\nwill be \u003Cem>inferred\u003C/em> to return Type Predicate if they hold the following conditions.\nMost of the times they will be inferred well\nif you wrote them in the way you would normally write Type Guard function.\u003C/p>\n\u003Col>\n\u003Cli>There should be no denoted return types or Type Predicate.\u003C/li>\n\u003Cli>There should be only one \u003Ccode>return\u003C/code> statement and no implicit returns.\u003C/li>\n\u003Cli>It should not modify the parameter.\u003C/li>\n\u003Cli>It should return \u003Ccode>boolean\u003C/code> expression with respect to the parameter.\u003C/li>\n\u003C/ol>\n\u003Cp>As with the first condition, you shouldn't even denote \u003Ccode>boolean\u003C/code> return type.\nAnd there is no meaning of inference if it explicitly returns Type Predicate.\u003C/p>\n\u003Cp>The second one tells that the inference needs the function to return explicitly.\nAlso keep in mind the return statement should not be more than one.\nThe next codes are examples of no inference.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token comment\">// No Inferred Type Predicate\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span> \n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token comment\">// No Inferred Type Predicate\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBirdNotFishOrDog\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish \u003Cspan class=\"token operator\">|\u003C/span> Dog\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"11\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'bark'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"12\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"13\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"14\">  \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>\u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"15\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">false\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"16\">  \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"17\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"18\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The fourth means that you need to actually inspect the type of parameter\nso that Typescript check the code path which would return \u003Ccode>true\u003C/code> or \u003Ccode>false\u003C/code>\nto infer Type Predicate.\nFor example the below would not work as it does not tell Typescript anything.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Oddly the following code does not work either.\nIf the returned value is \u003Ccode>true\u003C/code> it does mean that \u003Ccode>animal\u003C/code> is of \u003Ccode>Bird\u003C/code> type.\u003Cbr>\nIf you read the pull request of Inferred Type Predicate,\nType Guard must be \u003Cem>if and only if\u003C/em>.\nThus \u003Ccode>return 'fly' in animal &#x26;&#x26; Math.random() > 0.5\u003C/code> code\nmay return different boolean values according to the right hand side operand\neven though it is handed a \u003Ccode>Bird\u003C/code> parameter;\nas a result it is not a Type Guard function.\nNevertheless it does not quite explain why \u003Ccode>&#x26;&#x26; true\u003C/code> is not a Type Guard expression.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal \u003Cspan class=\"token operator\">&#x26;&#x26;\u003C/span> \u003Cspan class=\"token boolean\">true\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cbr>\n\u003Cp>There are more details that I could not introduce about Inferred Type Predicate,\nso for more please visite the official documentation and PR.\u003C/p>\n\u003Cp>\u003Ca href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates\">https://devblogs.microsoft.com/typescript/announcing-typescript-5-5-beta/#inferred-type-predicates\u003C/a>\n\u003Ca href=\"https://github.com/microsoft/TypeScript/pull/57465\">https://github.com/microsoft/TypeScript/pull/57465\u003C/a>\u003C/p>\n\u003Ch2 id=\"4-Type-Guard-Now-Flows\">Type Guard Now Flows\u003C/h2>\n\u003Cp>Now Type Guard in TypeScript now Flows!\nThat means, if you wrap a Type Guard function and return it as is\nType Predicate would be deprecated.\nBut as told earlier, since Type Predicate is now inferred, Type Predicate is also preserved.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token string\">'fly'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token comment\">// This function returns type predicate since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">wrappedGetIsBird\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token operator\">:\u003C/span> Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">  \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token function\">getIsBird\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"5-Breaking-Changes-in-Your-Code\">Breaking Changes in Your Code\u003C/h2>\n\u003Cp>From 5.5 as long as for normal functions if they hold the inference conditions\nthey will return Type Predicate not \u003Ccode>boolean\u003C/code>.\nIt means variable types could have changed unintentionally\nand leads to unwanted type errors.\u003C/p>\n\u003Cp>Even though type narrowing is not needed,\nsince Inferred Type Predicates check the types.\nIf you try to assign a value of type which is filtered out\nit may throws an error.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">declare\u003C/span> \u003Cspan class=\"token keyword\">const\u003C/span> animals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>arr\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">  \u003Cspan class=\"token keyword\">return\u003C/span> arr\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">filter\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animal \u003Cspan class=\"token operator\">=>\u003C/span> \u003Cspan class=\"token string\">'swim'\u003C/span> \u003Cspan class=\"token keyword\">in\u003C/span> animal\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">\u003Cspan class=\"token comment\">// We only wanted to filter out Birds, but the returned value\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token comment\">// now reject Bird!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"9\">\u003Cspan class=\"token keyword\">const\u003C/span> filteredAnimals \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animals\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"10\">filteredAnimals\u003Cspan class=\"token punctuation\">.\u003C/span>\u003Cspan class=\"token function\">push\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>newBird\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span> \u003Cspan class=\"token comment\">// Error since 5.5!\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/img/2024-05-18-ko-typescript-5-5-notable-changes/unwanted-inferred-type-predicate.png\" alt=\"unwanted-inferred-type-predicate\">\u003C/p>\n\u003Cp>Cases like this can be handled with explicit typings.\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">const\u003C/span> filteredAnimals\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>Bird \u003Cspan class=\"token operator\">|\u003C/span> Fish\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">[\u003C/span>\u003Cspan class=\"token punctuation\">]\u003C/span> \u003Cspan class=\"token operator\">=\u003C/span> \u003Cspan class=\"token function\">removeBirds\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>animals\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch1 id=\"6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses\">Control Flow Narrowing for Constant Indexed Accesses\u003C/h1>\n\u003Cp>Now as long as an object and a key are constant it can be type-narrowed!\u003C/p>\n\u003Cpre class=\"language-ts\">\u003Ccode class=\"language-ts code-highlight\">\u003Cspan class=\"code-line line-number\" line=\"1\">\u003Cspan class=\"token keyword\">function\u003C/span> \u003Cspan class=\"token function\">getDouble\u003C/span>\u003Cspan class=\"token punctuation\">(\u003C/span>obj\u003Cspan class=\"token operator\">:\u003C/span> Record\u003Cspan class=\"token operator\">&#x3C;\u003C/span>\u003Cspan class=\"token builtin\">string\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> \u003Cspan class=\"token builtin\">number\u003C/span> \u003Cspan class=\"token operator\">|\u003C/span> \u003Cspan class=\"token keyword\">null\u003C/span>\u003Cspan class=\"token operator\">>\u003C/span>\u003Cspan class=\"token punctuation\">,\u003C/span> key\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token builtin\">string\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span>\u003Cspan class=\"token operator\">:\u003C/span> \u003Cspan class=\"token builtin\">number\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"2\">    \u003Cspan class=\"token keyword\">if\u003C/span> \u003Cspan class=\"token punctuation\">(\u003C/span>obj\u003Cspan class=\"token punctuation\">[\u003C/span>key\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">)\u003C/span> \u003Cspan class=\"token punctuation\">{\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"3\">        \u003Cspan class=\"token keyword\">const\u003C/span> value \u003Cspan class=\"token operator\">=\u003C/span> obj\u003Cspan class=\"token punctuation\">[\u003C/span>key\u003Cspan class=\"token punctuation\">]\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"4\">        \u003Cspan class=\"token comment\">// This is fine since 5.5!\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"5\">        \u003Cspan class=\"token keyword\">return\u003C/span> value \u003Cspan class=\"token operator\">*\u003C/span> \u003Cspan class=\"token number\">2\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"6\">    \u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"7\">    \u003Cspan class=\"token keyword\">return\u003C/span> \u003Cspan class=\"token number\">0\u003C/span>\u003Cspan class=\"token punctuation\">;\u003C/span>\n\u003C/span>\u003Cspan class=\"code-line line-number\" line=\"8\">\u003Cspan class=\"token punctuation\">}\u003C/span>\n\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>In the code above as both \u003Ccode>obj\u003C/code> and \u003Ccode>key\u003C/code> are constant,\ninside the if block \u003Ccode>obj[key]\u003C/code> is gurantedd to be of \u003Ccode>number\u003C/code> type\nbut Typescript did not notice it.\nBut since 5.5 it can!\u003C/p>",frontmatter:{layout:"post",toc:true,title:"Typescript 5.5 Noticeable Changes",category:["Programming"],tags:["typescript"],author:["Ïù¥ÌòÑÏû¨"]},date:"2024-05-18",lang:"en",id:"05-18-en-typescript-5-5-notable-changes",tocData:[{depth:1,id:"1-Inferred-Type-Predicate",text:"Inferred Type Predicate"},{depth:2,id:"2-Advantages",text:"Advantages"},{depth:2,id:"3-Inference-Condition",text:"Inference Condition"},{depth:2,id:"4-Type-Guard-Now-Flows",text:"Type Guard Now Flows"},{depth:2,id:"5-Breaking-Changes-in-Your-Code",text:"Breaking Changes in Your Code"},{depth:1,id:"6-Control-Flow-Narrowing-for-Constant-Indexed-Accesses",text:"Control Flow Narrowing for Constant Indexed Accesses"}],langs:["ko","en"]},"uses":{"params":["year","slug"]}}];

					Promise.all([
						import("../../../_app/immutable/entry/start.7b02dd09.js"),
						import("../../../_app/immutable/entry/app.beba005d.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 5],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
	</body>
</html>
